<!DOCTYPE html>
  <html>
    <head>
      <title>mybatis</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///C:\Users\18271\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.3.0\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <ul>
<li><a href="#mybatis">Mybatis</a>
<ul>
<li><a href="#%E6%A6%82%E8%BF%B0">概述：</a></li>
<li><a href="#orm%E6%A1%86%E6%9E%B6">ORM框架：</a>
<ul>
<li><a href="#1%E6%A6%82%E8%BF%B0">1.概述：</a></li>
<li><a href="#2orm%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%98%A0%E5%B0%84%E6%96%B9%E5%BC%8F">2.ORM框架的基本映射方式：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E4%BD%BF%E7%94%A8%E5%89%8D%E6%8F%90">mybatis的使用前提：</a></li>
<li><a href="#mybatis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6sql%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AE%B2%E8%A7%A3">Mybatis的配置文件（全局配置文件，SQL映射配置文件）讲解：</a>
<ul>
<li><a href="#1mybatis-%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-mybatisconfigxml">1.Mybatis 全局配置文件 Mybatis—config.xml:</a>
<ul>
<li><a href="#2%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">②.引入外部配置文件：</a></li>
<li><a href="#3settings%E6%A0%87%E7%AD%BE%E8%AE%BE%E7%BD%AEmybatis%E7%9A%84%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE%E6%A0%87%E7%AD%BE">③.settings标签，设置Mybatis的主要配置标签：</a></li>
<li><a href="#4typealiases%E6%A0%87%E7%AD%BE%E4%B8%8D%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8">④.typeAliases标签（不推荐使用）：</a></li>
<li><a href="#5environments%E6%A0%87%E7%AD%BE%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">⑤.environments标签，运行环境配置：</a></li>
<li><a href="#6databaseidprovider%E6%A0%87%E7%AD%BE%E6%94%AF%E6%8C%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E8%A1%8C">⑥.databaseIdProvider标签,支持多数据库运行：</a></li>
<li><a href="#7mappers%E6%A0%87%E7%AD%BE">⑦.mappers标签：</a></li>
</ul>
</li>
<li><a href="#2mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6-~mapperxml">2.Mapper映射文件 ~Mapper.xml:</a>
<ul>
<li><a href="#1select">①.select</a></li>
<li><a href="#2insert-update-%E5%92%8C-delete">②.insert, update 和 delete</a></li>
<li><a href="#3%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86%E5%8D%95%E4%B8%AA%E5%8F%82%E6%95%B0%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1%E9%9B%86%E5%90%88">③.参数处理(单个参数，多个参数,对象，集合)：</a></li>
</ul>
</li>
<li><a href="#3-%E4%B8%8E-%E7%9A%84%E5%8C%BA%E5%88%AB">3.&quot;#{} 与 ${} 的区别&quot;：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84xml%E6%96%B9%E5%BC%8F%E4%BD%BF%E7%94%A8">Mybatis的XML方式使用：</a>
<ul>
<li><a href="#1%E5%AE%89%E8%A3%85mysql%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8">①安装MySQL,创建数据库,创建数据表：</a></li>
<li><a href="#2%E5%88%9B%E5%BB%BA%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%98%A0%E5%B0%84%E7%B1%BBjavabean%E5%AE%9E%E4%BD%93%E7%B1%BB">②创建持久化类（数据库映射类/javaBean/实体类）：</a></li>
<li><a href="#3%E5%88%9B%E5%BB%BAmybatis_configxml-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E5%AD%97blog_demo">③创建Mybatis_config.xml ， 数据库名字：blog_demo</a></li>
<li><a href="#4%E5%88%9B%E5%BB%BAstudentmapperxml-%E6%95%B0%E6%8D%AE%E8%A1%A8%E5%90%8D%E5%AD%97student">④创建studentMapper.xml  ，数据表名字：student</a></li>
<li><a href="#5%E5%88%9B%E5%BB%BAtest%E7%B1%BBmainjava">⑤创建test类，main.java</a></li>
</ul>
</li>
<li><a href="#mybatis-%E6%8E%A5%E5%8F%A3%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F-%E7%9B%B8%E6%AF%94%E4%B9%8B%E5%89%8D%E8%B0%83%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%96%B9%E5%BC%8F%E6%8E%A5%E5%8F%A3%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%8F%AA%E8%A6%81%E6%94%B9%E5%8A%A8%E5%87%A0%E4%B8%AA%E5%9C%B0%E6%96%B9">Mybatis 接口式编程方式， （相比之前调用数据库的方式，接口式编程的方式只要改动几个地方）：</a>
<ul>
<li><a href="#1%E5%A2%9E%E5%8A%A0%E4%BB%A3%E7%90%86%E6%8E%A5%E5%8F%A3-studentdaojava">①：增加代理接口： studentdao.java</a></li>
<li><a href="#2%E4%BF%AE%E6%94%B9%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%9A%84%E5%80%BC-studentmapperxml-%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4">②：修改映射文件的命名空间的值---studentMapper.xml 的命名空间：</a></li>
<li><a href="#3%E6%B5%8B%E8%AF%95%E7%B1%BB-mainjava">③测试类 ，main.java</a></li>
</ul>
</li>
<li><a href="#font-colorredresultmap%E6%B3%A8%E9%87%8A%E5%BE%88%E9%87%8D%E8%A6%81font">ResultMap（注释很重要）:</a>
<ul>
<li><a href="#1resultmap%E7%9A%84%E4%BD%9C%E7%94%A8%E6%A6%82%E8%BF%B0">1.ResultMap的作用概述：</a></li>
<li><a href="#2%E8%8B%A5%E8%A1%A8%E7%9A%84%E5%88%97%E5%90%8D%E4%B8%8E%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8D%E7%9B%B8%E5%90%8C%E5%8F%AF%E7%94%A8resultmap%E8%A7%A3%E5%86%B3">2.若表的列名与持久化类的属性名不相同，可用ResultMap解决：</a></li>
<li><a href="#3%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2association%E6%A0%87%E7%AD%BE">3.一对一关联查询（association标签）：</a></li>
<li><a href="#4%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2collection%E6%A0%87%E7%AD%BE">4.一对多关联查询（collection标签）：</a></li>
<li><a href="#5%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">5.多对多关联查询：</a>
<ul>
<li><a href="#1%E6%9F%A5%E8%AF%A2%E6%9F%90%E4%B8%AA%E7%8F%AD%E7%BA%A7%E6%97%B6%E6%8A%8A%E7%8F%AD%E7%BA%A7%E6%89%80%E5%9C%A8%E7%9A%84%E5%A4%9A%E4%B8%AA%E8%80%81%E5%B8%88%E4%B9%9F%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">①查询某个班级时，把班级所在的多个老师也查询出来：</a></li>
<li><a href="#2%E6%9F%A5%E8%AF%A2%E6%9F%90%E4%B8%AA%E8%80%81%E5%B8%88%E6%97%B6%E6%8A%8A%E8%80%81%E5%B8%88%E6%89%80%E5%9C%A8%E7%9A%84%E5%A4%9A%E4%B8%AA%E7%8F%AD%E7%BA%A7%E4%B9%9F%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">②查询某个老师时，把老师所在的多个班级也查询出来：</a></li>
<li><a href="#3%E6%8A%8A%E6%9F%A5%E8%AF%A2%E5%85%A8%E9%83%A8%E8%80%81%E5%B8%88%E7%9A%84%E5%90%8C%E6%97%B6%E6%8A%8A%E6%89%80%E6%9C%89%E8%80%81%E5%B8%88%E7%9A%84%E6%89%80%E6%95%99%E7%9A%84%E7%8F%AD%E7%BA%A7%E9%83%BD%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">③把查询全部老师的同时，把所有老师的所教的班级都查询出来：</a></li>
</ul>
</li>
<li><a href="#6%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E8%A1%A5%E5%85%85">6.关联查询补充：</a>
<ul>
<li><a href="#1%E6%87%92%E5%8A%A0%E8%BD%BD%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD">1.懒加载（延迟加载）：</a></li>
<li><a href="#2%E4%BD%BF%E7%94%A8associationcollection-%E6%A0%87%E7%AD%BE%E8%BF%9B%E8%A1%8C%E5%88%86%E5%B8%83%E6%9F%A5%E8%AF%A2%E6%97%B6%E5%8F%AF%E4%BB%A5%E4%BC%A0%E5%A4%9A%E5%88%97%E7%9A%84%E5%80%BC">2.使用association，collection 标签进行分布查询时，可以传多列的值：</a></li>
<li><a href="#3mybatis%E7%9A%84%E9%89%B4%E5%88%AB%E5%99%A8discriminator">3.MyBatis的鉴别器（discriminator）:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81sql">动态SQL:</a>
<ul>
<li><a href="#1if-%E8%AF%AD%E5%8F%A5-%E7%AE%80%E5%8D%95%E7%9A%84%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD">1.if 语句 (简单的条件判断)：</a></li>
<li><a href="#2choose-whenotherwize%E8%AF%AD%E5%8F%A5">2.choose (when,otherwize)语句：</a></li>
<li><a href="#3trim%E6%A0%87%E7%AD%BE%E5%B8%B8%E7%94%A8%E4%B8%89%E7%A7%8D%E7%94%A8%E6%B3%95">3.trim标签（常用，三种用法）</a></li>
<li><a href="#4where">4.where</a></li>
<li><a href="#5set%E8%AF%AD%E5%8F%A5%E9%80%82%E7%94%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E6%9B%B4%E6%96%B0">5.set语句（适用与动态更新）：</a></li>
<li><a href="#6foreach%E8%AF%AD%E5%8F%A5">6.foreach语句：</a></li>
<li><a href="#7bind%E8%AF%AD%E5%8F%A5%E6%88%91%E4%B9%9F%E4%B8%8D%E5%A4%AA%E4%BC%9A">7.bind语句(我也不太会)：</a></li>
<li><a href="#8sqlinclude-%E6%A0%87%E7%AD%BE%E6%8A%BD%E5%8F%96%E5%8F%AF%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8%E7%9A%84sql%E7%89%87%E6%AE%B5%E6%96%B9%E4%BE%BF%E5%BC%95%E7%94%A8">8.sql，include 标签（抽取可重复使用的sql片段，方便引用）：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6">Mybatis的缓存机制：</a>
<ul>
<li><a href="#%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98sqlsession-%E7%BA%A7%E5%88%AB">一级缓存（SqlSession 级别）：</a></li>
<li><a href="#%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98mapper-%E7%BA%A7%E5%88%AB">二级缓存（mapper 级别）：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E6%96%B9%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8">Mybatis的基于注解的方式的使用：</a>
<ul>
<li><a href="#1%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8">1.配置与使用：</a></li>
<li><a href="#2mybatis%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3">2.Mybatis常用注解：</a></li>
<li><a href="#2%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E7%9A%84%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">2.基于注解方式的关联查询：</a>
<ul>
<li><a href="#1%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">1.一对一关联查询：</a></li>
<li><a href="#2%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">2.一对多关联查询 ？：</a></li>
<li><a href="#3%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E6%87%92%E5%BE%97%E5%86%99%E5%A5%BD%E9%BA%BB%E7%83%A6">3.多对多关联查询(懒得写，好麻烦):</a></li>
</ul>
</li>
<li><a href="#3%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8A%A8%E6%80%81sql">3.基于注解方式的动态SQL：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%9C%8B%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">Mybatis的事务(看参考链接)：</a></li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="mybatis">Mybatis</h1>

<h2 class="mume-header" id="&#x6982;&#x8FF0;">概述：</h2>

<p>  MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架。MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集。MyBatis 可以对配置和原生Map使用简单的 XML 或注解，将接口和 Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录。</p>
<h2 class="mume-header" id="orm&#x6846;&#x67B6;">ORM框架：</h2>

<p>目前流行的ORM框架：<br>
JPA , <a href="https://baike.baidu.com/item/Hibernate/206989?fr=aladdin">Hibernate</a> , <font color="red">Mybatis(半ORM框架)</font></p>
<p>Hibernate： 会根据数据库的表的结构，自动生成SQL语句，它提供全面的数据库封装机制。<br>
Mybatis：这里的半ORM框架，是相对与Hibernate 这种提供全面的数据库封装机制的“全自动化ORM框架”而言。mybatis不会为程序员在运行期间自动生成 sql 语句执行，具体的sql 语句需要程序员自己编写，然后通过映射配置文件，把sql语句与持久化类进行一一对应。</p>
<h3 class="mume-header" id="1&#x6982;&#x8FF0;">1.概述：</h3>

<p>  <strong>对象关系映射</strong>(<font color="red">Object Relational Mapping</font>，简称ORM，或O/RM，或O/R mapping），是一种程序技术，用于实现面向对象编程语言里不同类型系统的数据之间的转换。从效果上说，它其实是创建了一个可在编程语言里使用的--“虚拟对象数据库”。<br>
  对象关系映射技术:<strong><font color="red">用来把对象模型表示的对象映射到基于S Q L 的关系模型数据库结构中去</font></strong>。这样，我们在具体的操作实体对象的时候，就<strong color="blue">不需要再去和复杂的 SQ L 语句打交道，只需简单的操作实体对象的属性和方法</strong>。<br>
O R M 技术是在对象和关系之间提供了一条桥梁，前台的对象型数据和数据库中的关系型的数据通过这个桥梁来相互转化。</p>
<h3 class="mume-header" id="2orm&#x6846;&#x67B6;&#x7684;&#x57FA;&#x672C;&#x6620;&#x5C04;&#x65B9;&#x5F0F;">2.ORM框架的基本映射方式：</h3>

<ol>
<li>数据表映射类（持久化类/实体类/entity/pojo）：<br>
  数据库的一个表对应一个映射类（普通的javaBean类),程序对持久话类的操作，ORM框架会转化为对应的数据库表的操作（<font color="red">当程序使用这个持久化类生成实例化对象，删除对象，修改对象中的属性值时，会被自动转化为对数据表的对应的CRUD操作。</font>）。</li>
<li>数据表的行映射对象：<br>
  持久化类对产生许多实例化对象，<font color="red">每个实例化对象对应数据表的一行记录。</font>当程序操作对象，就相当与操作表中对应的一行记录。</li>
<li>数据表的列（字段）映射对象的属性：<br>
  <strong>当程序修改某个持久化类的某个实例化对象的属性时，就相当与修改某数据表的某一条记录的某一个列（字段）的数据。</strong></li>
</ol>
<h2 class="mume-header" id="mybatis&#x7684;&#x4F7F;&#x7528;&#x524D;&#x63D0;">mybatis的使用前提：</h2>

<p>①要使用 MyBatis， 只需将 mybatis-x.x.x.jar 文件置于应用程序的 classpath 中即可。<font color="red">由于Mybatis的底层是基于JDBC 的，因此还要还少不了JDBC驱动的，不同的数据库使用不同的数据库驱动。我这里使用的是MySQL数据库。</font></p>
<p>Mysql的数据库驱动 ： mysql-connector-java-5.1.42-bin.jar<br>
Mybatis jar包：mybatis-3.4.3.jar</p>
<p>②如果使用 Maven 来构建项目，则需将下面的 dependency 代码置于 pom.xml 文件中：</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>x.x.x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>     <span class="token comment" spellcheck="true">&lt;!--mybatis的版本号--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>x.x.x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
</pre>
<h2 class="mume-header" id="mybatis&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x6587;&#x4EF6;sql&#x6620;&#x5C04;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x8BB2;&#x89E3;">Mybatis的配置文件（全局配置文件，SQL映射配置文件）讲解：</h2>

<p>参考链接：<br>
<a href="http://www.mybatis.org/mybatis-3/zh/configuration.html">推荐使用官方settings的文档</a></p>
<h3 class="mume-header" id="1mybatis-&#x5168;&#x5C40;&#x914D;&#x7F6E;&#x6587;&#x4EF6;-mybatisconfigxml">1.Mybatis 全局配置文件 Mybatis—config.xml:</h3>

<p><strong>注意:</strong><br>
<font color="red">全局配置文件中的各个标签的先后位置，不能弄错，否则报错。</font><br>
各个标签先后顺序：<br>
properties, settings, typeAliases, typeHandlers, objectFactory, objectWrapperFactory, reflectorFactory, plugins, environments, databaseIdProvider, mappers</p>
<h4>①.规定Mybatis的xml标签语法规则的dtd文件（主要用于代码提示）：</h4>
<p><font color="red">dtd文件分为两种，全局配置dtd文件，sql映射配置dtd文件。</font></p>
<p>Mybatis-config.xml</p>
<pre class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype">&lt;!DOCTYPE configuration
 PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-config.dtd"></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
....
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
</pre>
<p>上面代码中的<code>&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</code>，用于代码提示。</p>
<p>StudentMapper.xml</p>
<pre class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype">&lt;!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"></span>
<span class="token comment" spellcheck="true">&lt;!-- 为mapper指定唯一的命名空间，在不用接口式编程的情况下，随便取名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.studentdao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
~ ~ ~
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span>

</pre>
<p>上面代码中的<code>&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</code>，用于代码提示。</p>
<h4 class="mume-header" id="2&#x5F15;&#x5165;&#x5916;&#x90E8;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">②.引入外部配置文件：</h4>

<p><strong>Mybatis通过 properties 标签来引入外部 properties配置文件。</strong></p>
<p><img src="../img/mybatis_img/20.png" alt="&#x6587;&#x6863;&#x7ED3;&#x6784;&#x56FE;"></p>
<p>config.properties(外部 properties配置文件):</p>
<pre class="language-">jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/blog_demo?useUnicode=true&amp;amp;characterEncoding=utf8
jdbc.username=root
jdbc.password=123456
</pre>
<p>Mybatis2_config.xml(<font color="red">讲解Mybtis配置文件时使用，临时的</font>) :</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>config.properties<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token comment" spellcheck="true">&lt;!-- 
	resource 属性： 引入类路径下的配置文件。
	url 属性: 引入网上，磁盘上的配置文件。
--></span>
<span class="token comment" spellcheck="true">&lt;!--环境配置： 指定要连接的数据库--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
		 		<span class="token comment" spellcheck="true">&lt;!--${jdbc.driver} 从配置文件获取driver的信息  --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.driver}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.url}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.username}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.password}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">></span></span>
</pre>
<h4 class="mume-header" id="3settings&#x6807;&#x7B7E;&#x8BBE;&#x7F6E;mybatis&#x7684;&#x4E3B;&#x8981;&#x914D;&#x7F6E;&#x6807;&#x7B7E;">③.settings标签，设置Mybatis的主要配置标签：</h4>

<p>参考链接：<br>
<a href="http://www.mybatis.org/mybatis-3/zh/configuration.html">推荐使用官方settings的文档</a></p>
<p>一个配置完整的 settings 元素的示例如下：<br>
Mybatis2_config.xml</p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cacheEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lazyLoadingEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipleResultSetsEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>useColumnLabel<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>useGeneratedKeys<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>autoMappingBehavior<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PARTIAL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>autoMappingUnknownColumnBehavior<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>WARNING<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>defaultExecutorType<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SIMPLE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>defaultStatementTimeout<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>defaultFetchSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>safeRowBoundsEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mapUnderscoreToCamelCase<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>localCacheScope<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SESSION<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbcTypeForNull<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>OTHER<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lazyLoadTriggerMethods<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>equals,clone,hashCode,toString<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>
</pre>
<h4 class="mume-header" id="4typealiases&#x6807;&#x7B7E;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;">④.typeAliases标签（不推荐使用）：</h4>

<p>typeAliases标签是为 Java 类型设置一个短的名字，<font color="blue">别名(不区分大小写)</font>。它只和 XML 配置有关，存在的意义仅在于用来减少类完全限定名的冗余。<br>
Mybatis2_config.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAlias</span> <span class="token attr-name">alias</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stu<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAlias</span> <span class="token attr-name">alias</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAlias</span> <span class="token attr-name">alias</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tea<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Teacher<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!--当没有设置 alies 属性(指定新的别名)时，默认别名为 类名的小写，如student，school_class,teacher--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">></span></span>

</pre>
<p><strong>当这样配置时，stu可以用在任何使用com.entity.Student的地方。</strong></p>
<p>如果要批量起别名，也可以指定一个包名，MyBatis 会在包名下面搜索需要的 Java Bean，比如:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">></span></span>
</pre>
<p><font color="red">每一个在包 com.entity 中的 Java Bean，在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名。 比如com.entity.Student 的别名为 student；若有注解，则别名为其注解值。</font><br>
看下面的例子：</p>
<pre class="language-java"><span class="token annotation punctuation">@Alias</span><span class="token punctuation">(</span><span class="token string">"stu"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</pre>
<h4 class="mume-header" id="5environments&#x6807;&#x7B7E;&#x8FD0;&#x884C;&#x73AF;&#x5883;&#x914D;&#x7F6E;">⑤.environments标签，运行环境配置：</h4>

<p>参考链接：<br>
<a href="http://www.mybatis.org/mybatis-3/zh/configuration.html">推荐使用官方settings的文档</a></p>
<p>MyBatis 可以配置成适应多种环境，这种机制有助于将 SQL 映射应用于多种数据库之中， 现实情况下有多种理由需要这么做。例如，开发、测试和生产环境需要有不同的配置；或者共享相同 Schema 的多个生产数据库， 想使用相同的 SQL 映射。许多类似的用例。<br>
<strong>不过要记住：尽管可以配置多个环境，每个 SqlSessionFactory 实例只能选择其一。</strong><br>
所以，如果你想连接两个数据库，就需要创建两个 SqlSessionFactory 实例，每个数据库对应一个。而如果是三个数据库，就需要三个实例，依此类推</p>
<pre class="language-xml"><span class="token comment" spellcheck="true">&lt;!--environments 运行环境配置，
   mybatis可以配置多种不同的 environment标签，每个environment标签对于不同的运行环境（数据库，...）,
   但一次只能选择一种运行环境。
	default="mysql" ：指定的运行环境为 mysql，一次只能选一种。该属性的值为 environment的id属性值
	&lt;transactionManager type="JDBC"/> ： mybatis的事务管理的选择，详情请看事务文档 
	 &lt;dataSource type="POOLED">  ：数据源配置。
	 		mybatis自带的数据源：该配置的type 有三个值可选： type=“[UNPOOLED|POOLED|JNDI]”。
	 		若想使用自定义数据源（c3p0，dbcp）：实现DateSource接口，type 的值为自定义数据源的全类名。
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

	<span class="token comment" spellcheck="true">&lt;!-- mybatis 运行oracle的环境配置 --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oracle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- environment 标签中必须有 transactionManager，dataSource 标签 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
		 		<span class="token comment" spellcheck="true">&lt;!--${oracle.driver} 从配置文件获取driver的信息  
				 	注意：不同的数据库，你的 驱动jar包要齐全。
				 
				 --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${oracle.driver}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${oracle.url}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${oracle.username}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${oracle.password}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
	
	<span class="token comment" spellcheck="true">&lt;!-- mybatis 运行mysql的环境配置 --></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
		 		<span class="token comment" spellcheck="true">&lt;!--${jdbc.driver} 从配置文件获取driver的信息  --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.driver}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.url}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.username}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.password}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">></span></span>
</pre>
<p>其中的一些标签：<br>
<code>&lt;dataSource type=&quot;POOLED&quot;&gt;</code><br>
该配置的type 有三个值可选： type=“[UNPOOLED|POOLED|JNDI]”。</p>
<p>UNPOOLED : 这个数据源的实现只是每次被请求时打开和关闭连接。虽然一点慢，它对在及时可用连接方面没有性能要求的简单应用程序是一个很好的选择。 不同的数据库在这方面表现也是不一样的，所以对某些数据库来说使用连接池并不重要，这个配置也是理想的</p>
<p>POOLED– 这种数据源的实现利用“池”的概念将 JDBC 连接对象组织起来，避免了创建新的连接实例时所必需的初始化和认证时间。 这是一种使得并发 Web 应用快速响应请求的流行处理方式.</p>
<p>JNDI– 这个数据源的实现是为了能在如 EJB 或应用服务器这类容器中使用，容器可以集中或在外部配置数据源，然后放置一个 JNDI 上下文的引用。</p>
<h4 class="mume-header" id="6databaseidprovider&#x6807;&#x7B7E;&#x652F;&#x6301;&#x591A;&#x6570;&#x636E;&#x5E93;&#x8FD0;&#x884C;">⑥.databaseIdProvider标签,支持多数据库运行：</h4>

<p>MyBatis 可以根据不同的数据库厂商执行不同的语句，这种多厂商的支持是基于~Mapper.xml映射文件的sql标签语句中的 databaseId 属性。<br>
<font color="red">MyBatis 会加载不带 databaseId 属性和带有匹配当前数据库 databaseId 属性的所有语句。如果同时找到带有 databaseId 和不带 databaseId 的相同语句，则后者会被舍弃。</font></p>
<p>为支持多厂商特性只要像在 mybatis-config.xml 文件中加入 databaseIdProvider 即可：</p>
<p>mybatis-config.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>databaseIdProvider</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>DB_VENDOR<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SQL Server<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sqlserver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MySQL<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Oracle<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oracle<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token comment" spellcheck="true">&lt;!--为不同的数据库厂商标识起别名--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>databaseIdProvider</span><span class="token punctuation">></span></span>
</pre>
<p>type=&quot;DB_VENDOR&quot; ：<font color="blue">得到不同数据库厂商的标识，通过标识来执行不同数据库对应的Mapper映射文件的sql语句。</font></p>
<p>studentMapper.xml:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass<span class="token punctuation">"</span></span> <span class="token attr-name">databaseId</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!--
	注意若没有 databaseId 的属性，不管运行环境是那个调用此方法时，sql语句都会执行。

	上面是当运行环境为 mysql 时，会调用该sql语句。
	下面是当运行环境为 oracle 时，会调用该sql语句。
--></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass<span class="token punctuation">"</span></span> <span class="token attr-name">databaseId</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oracle<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

</pre>
<h4 class="mume-header" id="7mappers&#x6807;&#x7B7E;">⑦.mappers标签：</h4>

<p>告诉 MyBatis 到哪里去找映射文件。</p>
<pre class="language-xml">	<span class="token comment" spellcheck="true">&lt;!-- mappers标签告诉mybatis去哪里找sql（持久化类的）映射文件 --></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
		 		<span class="token comment" spellcheck="true">&lt;!-- 引用类路径下的Mapper映射文件 --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/studentMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		
		 		<span class="token comment" spellcheck="true">&lt;!-- 引用Mapper映射文件对应的接口文件，在基于注解方式使用mybatis时 --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span>  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao3.studentdao_dynamicSQL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		
		 		<span class="token comment" spellcheck="true">&lt;!--  引用磁盘路径下的Mapper映射文件  --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file:///c/mappers/studentMapepr.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>
</pre>
<h3 class="mume-header" id="2mapper&#x6620;&#x5C04;&#x6587;&#x4EF6;-~mapperxml">2.Mapper映射文件 ~Mapper.xml:</h3>

<p>  MyBatis 的真正强大在于它的映射语句,如果拿它跟具有相同功能的 JDBC 代码进行对比，你会立即发现省掉了将近 95% 的代码。</p>
<p>SQL 映射文件有很少的几个顶级元素（按照它们应该被定义的顺序）：</p>
<blockquote>
<p>cache – 给定命名空间的缓存配置。<br>
cache-ref – 其他命名空间缓存配置的引用。<br>
resultMap – 是最复杂也是最强大的元素，用来描述如何从数据库结果集中来加载对象。<br>
sql – 可被其他语句引用的可重用语句块。<br>
insert – 映射插入语句<br>
update – 映射更新语句<br>
delete – 映射删除语句<br>
select – 映射查询语句</p>
</blockquote>
<h4 class="mume-header" id="1select">①.select</h4>

<p>简单查询的 select 元素是非常简单的。比如：</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectPerson<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hashmap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  SELECT * FROM PERSON WHERE ID = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
</pre>
<p>这个语句被称作 selectPerson，接受一个 int（或 Integer）类型的参数，并返回一个 HashMap 类型的对象，其中的键是列名，值便是结果行中的对应值。</p>
<p><strong>select 元素有很多属性允许你配置，来决定每条语句的作用细节。</strong></p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectPerson<span class="token punctuation">"</span></span>   
  <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span>
  <span class="token attr-name">parameterMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deprecated<span class="token punctuation">"</span></span>
  <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hashmap<span class="token punctuation">"</span></span>
  <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>personResultMap<span class="token punctuation">"</span></span>
  <span class="token attr-name">flushCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span>
  <span class="token attr-name">useCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
  <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10000<span class="token punctuation">"</span></span>
  <span class="token attr-name">fetchSize</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>256<span class="token punctuation">"</span></span>
  <span class="token attr-name">statementType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PREPARED<span class="token punctuation">"</span></span>
  <span class="token attr-name">resultSetType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>FORWARD_ONLY<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

</pre>
<p>id:命名空间中唯一的标识符.<br>
parameterType： <font color="blue">将会传入这条语句的参数类的完全限定名或别名。这个属性是可选的，因为 MyBatis 可以通过TypeHandler 推断出具体传入语句的参数，默认值为 unset。</font></p>
<p>resultType:	从这条语句中返回的期望类型的类的完全限定名或别名。注意如果是集合情形，那应该是集合可以包含的类型，而不能是集合本身。使用 resultType 或 resultMap，但不能同时使用。</p>
<p>resultMap :	外部 resultMap 的命名引用。结果集的映射是 MyBatis 最强大的特性，对其有一个很好的理解的话，许多复杂映射的情形都能迎刃而解。使用 resultMap 或 resultType，但不能同时使用.</p>
<p>flushCache :将其设置为 true，任何时候只要语句被调用，都会导致本地缓存和二级缓存都会被清空，默认值：false。</p>
<p>useCache: 将其设置为 true，将会导致本条语句的结果被二级缓存，默认值：对 select 元素为 true。</p>
<p>timeout	:这个设置是在抛出异常之前，驱动程序等待数据库返回请求结果的秒数。默认值为 unset（依赖驱动）。</p>
<p>fetchSize:这是尝试影响驱动程序每次批量返回的结果行数和这个设置值相等。默认值为 unset（依赖驱动）。</p>
<p>statementType: STATEMENT，PREPARED 或 CALLABLE 的一个。这会让 MyBatis 分别使用 Statement,PreparedStatement 或 CallableStatement，默认值：PREPARED。</p>
<p>resultSetType: FORWARD_ONLY，SCROLL_SENSITIVE 或 SCROLL_INSENSITIVE 中的一个，默认值为 unset （依赖驱动）。</p>
<p>databaseId	:如果配置了 databaseIdProvider，MyBatis 会加载所有的不带 databaseId 或匹配当前 databaseId 的语句；如果带或者不带的语句都有，则不带的会被忽略。</p>
<p>resultOrdered :这个设置仅针对嵌套结果 select 语句适用：如果为 true，就是假设包含了嵌套结果集或是分组了，这样的话当返回一个主结果行的时候，就不会发生有对前面结果集的引用的情况。这就使得在获取嵌套的结果集的时候不至于导致内存不够用。默认值：false。</p>
<p>resultSets :这个设置仅对多结果集的情况适用，它将列出语句执行后返回的结果集并每个结果集给一个名称，名称是逗号分隔的。</p>
<h4 class="mume-header" id="2insert-update-&#x548C;-delete">②.insert, update 和 delete</h4>

<p>简单的insert, update 和 delete例子：</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertAuthor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  insert into Author (id,username,password,email,bio)
  values (#{id},#{username},#{password},#{email},#{bio})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>updateAuthor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  update Author set
    username = #{username},
    password = #{password},
    email = #{email},
    bio = #{bio}
  where id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deleteAuthor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  delete from Author where id = #{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">></span></span>
</pre>
<p>insert, update 和 delete 元素有很多属性允许你配置，来决定每条语句的作用细节。</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertAuthor<span class="token punctuation">"</span></span>
  <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>domain.blog.Author<span class="token punctuation">"</span></span>
  <span class="token attr-name">flushCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
  <span class="token attr-name">statementType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PREPARED<span class="token punctuation">"</span></span>
  <span class="token attr-name">keyProperty</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span>
  <span class="token attr-name">keyColumn</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>
  <span class="token attr-name">useGeneratedKeys</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>           
  <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--
useGeneratedKeys="":获取自动生成的主键的值。
 keyProperty="id" ：把获取到的主键的值，交给javaBean的那个属性。
--></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>updateAuthor<span class="token punctuation">"</span></span>
  <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>domain.blog.Author<span class="token punctuation">"</span></span>
  <span class="token attr-name">flushCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
  <span class="token attr-name">statementType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PREPARED<span class="token punctuation">"</span></span>
  <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deleteAuthor<span class="token punctuation">"</span></span>
  <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>domain.blog.Author<span class="token punctuation">"</span></span>
  <span class="token attr-name">flushCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
  <span class="token attr-name">statementType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PREPARED<span class="token punctuation">"</span></span>
  <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</pre>
<p>useGeneratedKeys :<font color="red">（仅对 insert 和 update 有用）这会令 MyBatis 使用 JDBC 的 getGeneratedKeys 方法来取出由数据库内部生成的主键（比如：像 MySQL 和 SQL Server 这样的关系数据库管理系统的自动递增字段），默认值：false。</font></p>
<p>keyProperty	:（仅对 insert 和 update 有用）唯一标记一个属性，MyBatis 会通过 getGeneratedKeys 的返回值或者通过 insert 语句的 selectKey 子元素设置它的键值，默认：unset。如果希望得到多个生成的列，也可以是逗号分隔的属性名称列表。</p>
<p>keyColumn:（仅对 insert 和 update 有用）通过生成的键值设置表中的列名，这个设置仅在某些数据库（像 PostgreSQL）是必须的，当主键列不是表中的第一列的时候需要设置。如果希望得到多个生成的列，也可以是逗号分隔的属性名称列表。</p>
<h4 class="mume-header" id="3&#x53C2;&#x6570;&#x5904;&#x7406;&#x5355;&#x4E2A;&#x53C2;&#x6570;&#x591A;&#x4E2A;&#x53C2;&#x6570;&#x5BF9;&#x8C61;&#x96C6;&#x5408;">③.参数处理(单个参数，多个参数,对象，集合)：</h4>

<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  insert into users (id, username, password)
  values (#{id}, #{username}, #{password})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

</pre>
<p><strong>如果 User 类型的参数对象传递到了语句中，id、username 和 password 属性将会被查找，然后将它们的值传入预处理语句的参数中。</strong></p>
<p><strong>①.单个单数：</strong><br>
当代理接口的参数为单个时，Mybatis不会做特殊处理。<br>
#{参数名} ： 取出参数值。</p>
<p>School_classMapper.xml:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass_canshu<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where name=#{name}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

</pre>
<p>School_classdao.java:</p>
<pre class="language-java"><span class="token keyword">public</span> School_class <span class="token function">selectClass_canshu</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p><strong>②.多个单数：</strong><br>
当代理接口的参数为多个时。Mybatis就不太清楚，怎么把参数与sql语句的#{}，#{}，...一一对应：<br>
<font color="red">此时，需要使用@Param</font><br>
@Param：明确绑定接口参数与sql语句的#{xxx}</p>
<p>School_classMapper.xml:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass_canshu<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where id=#{id} and name=#{name}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

</pre>
<p>School_classdao.java:</p>
<pre class="language-java"><span class="token keyword">public</span> School_class <span class="token function">selectClass_canshu</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>Integer id<span class="token punctuation">,</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>String name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p><font color="blue">上面这段代码中的@Param，明确的把sql的#{id},绑定为参数的id ，把sql的#{name},绑定为参数的name</font></p>
<p><strong>③.对象：</strong></p>
<pre class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertUser<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>User<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  insert into users (id, username, password)
  values (#{id}, #{username}, #{password})
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

</pre>
<p><font color="red">如果 User 类型的代理接口的参数对象传递到了sql语句中，id、username 和 password 属性将会被查找，然后将它们的值传入预处理语句的参数中。</font></p>
<p><strong>④.集合（List）：</strong><br>
  如果返回集合对象，</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectAllSchool_class<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from student 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
</pre>
<pre class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>School_class<span class="token operator">></span> <span class="token function">selectAllSchool_class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p><font color="bule">当代理接口的某个方法返回集合类型时，sql语句的 resultType=&quot;com.entity.School_class&quot;，写为集合内每个元素的类型，则mybatis，会把多个查询出来的元素，自动封装为集合。</font></p>
<h3 class="mume-header" id="3-&#x4E0E;-&#x7684;&#x533A;&#x522B;">3.&quot;#{} 与 ${} 的区别&quot;：</h3>

<p>  #{} :以预编译的方式，把参数设置到sql语句中，类似JDBC的PreparedStatement;用于防止sql注入。<br>
  ${} :直接把参数的值，拼接在sql语句中，有安全问题。<br>
 其他方面，没有问题。</p>
<h2 class="mume-header" id="mybatis&#x7684;xml&#x65B9;&#x5F0F;&#x4F7F;&#x7528;">Mybatis的XML方式使用：</h2>

<p>porject 类视图(所建项目为Dynamic web project)：<br>
<img src="../img/mybatis_img/3.png" alt="demo &#x7C7B;&#x89C6;&#x56FE;"></p>
<h3 class="mume-header" id="1&#x5B89;&#x88C5;mysql&#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x8868;">①安装MySQL,创建数据库,创建数据表：</h3>

<p>安装mysql，===》<font color="red">请自行百度</font><br>
推荐一个数据库图形界面工具：<a href="http://www.navicat.com.cn/">Navicat</a></p>
<p>数据库截图：<br>
<img src="../img/mybatis_img/1.png" alt="&#x6570;&#x636E;&#x5E93;&#x622A;&#x56FE;"><br>
数据表截图：<br>
<img src="../img/mybatis_img/2.png" alt="&#x6570;&#x636E;&#x5E93;&#x622A;&#x56FE;"></p>
<h3 class="mume-header" id="2&#x521B;&#x5EFA;&#x6301;&#x4E45;&#x5316;&#x7C7B;&#x6570;&#x636E;&#x5E93;&#x6620;&#x5C04;&#x7C7B;javabean&#x5B9E;&#x4F53;&#x7C7B;">②创建持久化类（数据库映射类/javaBean/实体类）：</h3>

<p>Student.java</p>
<pre class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>entity<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>
	<span class="token keyword">private</span> String name<span class="token punctuation">;</span>
	<span class="token keyword">private</span> Integer age<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

	<span class="token keyword">public</span> Integer <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> id<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> String <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>String name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> Integer <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span>Integer age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">"Student [id="</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">", name="</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">", age="</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre>
<h3 class="mume-header" id="3&#x521B;&#x5EFA;mybatis_configxml-&#x6570;&#x636E;&#x5E93;&#x540D;&#x5B57;blog_demo">③创建Mybatis_config.xml ， 数据库名字：blog_demo</h3>

<p>Mybatis_config.xml ---<strong>通过mybatis配置文件来告诉mybatis 连接那个数据库，以及连接数据库的用户名，密码等信息。</strong></p>
<pre class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype">&lt;!DOCTYPE configuration
 PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-config.dtd"></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--环境配置： 指定要连接的数据库--></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environments</span> <span class="token attr-name">default</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transactionManager</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JDBC<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment" spellcheck="true">&lt;!-- 事务管理 --></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataSource</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POOLED<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- datasource 数据源配置--></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.mysql.jdbc.Driver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbc:mysql://localhost:3306/blog_demo?useUnicode<span class="token punctuation">=</span>true&amp;amp; characterEncoding<span class="token punctuation">=</span>utf8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>123456<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataSource</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environments</span><span class="token punctuation">></span></span>
 		
		<span class="token comment" spellcheck="true">&lt;!-- mappers标签告诉mybatis去哪里找sql（持久化类的）映射文件 --></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/studentMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>
		
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>


</pre>
<h3 class="mume-header" id="4&#x521B;&#x5EFA;studentmapperxml-&#x6570;&#x636E;&#x8868;&#x540D;&#x5B57;student">④创建studentMapper.xml  ，数据表名字：student</h3>

<p>studentMapper.xml----(<font color="red">Mybatis 通过XML 文件去完成持久化类与数据库表之间的映射关系</font>)</p>
<pre class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype">&lt;!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"></span>

<span class="token comment" spellcheck="true">&lt;!-- 为mapper指定唯一的命名空间，在不用接口式编程的情况下，随便取名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.StudentMapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--#{id}:从传递过来的参数取出id值--></span>

<span class="token comment" spellcheck="true">&lt;!--动态插入数据--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertStudent<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>         
insert into student
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
		
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>name !<span class="token punctuation">=</span> null and name !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
             name,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>age !<span class="token punctuation">=</span> null and age !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
             age,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
     
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>values (<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>name !<span class="token punctuation">=</span> null and name !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
            		 #{name},
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>age !<span class="token punctuation">=</span> null and age !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
		              #{age},
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 动态删除的sql语句 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deleteStudent<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
delete from student where 1=1
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and age=#{age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">></span></span>
		

<span class="token comment" spellcheck="true">&lt;!--动态更新数据--></span>		
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>updateStudent<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
update student
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>set<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>name=#{name},<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>age=#{age},<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>
	where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--动态查询数据--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectStudent<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from student where 1=1
	 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and age=#{age}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!-- 查询全部数据 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectAllStudent<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		select * from student
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span>

</pre>
<h3 class="mume-header" id="5&#x521B;&#x5EFA;test&#x7C7B;mainjava">⑤创建test类，main.java</h3>

<p>main.java ---测试mybatis的CRUD操作：</p>
<pre class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>test<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Resources<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSession<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSessionFactory<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSessionFactoryBuilder<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>Student<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">main</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">/*
		 * 1.通过输入流来读取mybatis的配置文件信息。告诉程序连接的数据库，用户名，密码。以及到哪里去寻找 持久化类与数据表的映射文件
		 * 2.通过xml配置文件信息，初始化mybatis ， 创建SqlSessionFactory
		 * 3.通过SqlSessionFactory，实例化session 对象
		 * 4.创建你要操作的数据对象
		 * 5.找到Mapper映射文件的对应的sql语句，通过映射文件袋命名空间+对应SQL语句的id ，例如："com.dao.StudentMapper.insertStudent"
		 * 6.对操作对象实行CRUD 方法
		 * */</span>
		
		
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory,</span>

<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Student stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//找到Mapper映射文件的对应的sql语句，通过映射文件袋命名空间+对应SQL语句的id</span>
		
		
<span class="token comment" spellcheck="true">//		session.insert("com.dao.StudentMapper.insertStudent", stu);</span>
<span class="token comment" spellcheck="true">//		session.commit();         //提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		stu<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">//修改数据要知道id</span>
		stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">"com.dao.StudentMapper.updateStudent"</span><span class="token punctuation">,</span> stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		Student sa<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token string">"com.dao.StudentMapper.selectStudent"</span><span class="token punctuation">,</span> stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">int</span> a<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"com.dao.StudentMapper.deleteStudent"</span><span class="token punctuation">,</span> stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		
		session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre>
<h2 class="mume-header" id="mybatis-&#x63A5;&#x53E3;&#x5F0F;&#x7F16;&#x7A0B;&#x65B9;&#x5F0F;-&#x76F8;&#x6BD4;&#x4E4B;&#x524D;&#x8C03;&#x7528;&#x6570;&#x636E;&#x5E93;&#x7684;&#x65B9;&#x5F0F;&#x63A5;&#x53E3;&#x5F0F;&#x7F16;&#x7A0B;&#x7684;&#x65B9;&#x5F0F;&#x53EA;&#x8981;&#x6539;&#x52A8;&#x51E0;&#x4E2A;&#x5730;&#x65B9;">Mybatis 接口式编程方式， （相比之前调用数据库的方式，接口式编程的方式只要改动几个地方）：</h2>

<p>  接口式编程，我们可以简单的理解是<font color="red"> Mybatis 为连接持久化类与数据表之间的映射文件定义了一个代理接口，以后全部通过这个接口来和映射文件交互，而不再是使用以前方法。</font><br>
  映射文件如何知道自己被哪个接口代理呢？这里就是通过名称空间来实现的，<strong>映射文件的名称空间再也不是随心所欲的定义的了，而是要使用代理接口的全限定名作为其名称空间。所谓全限定名，就是接口所在的包名加上接口名称。</strong></p>
<p><strong>类路径图：</strong><br>
<img src="../img/mybatis_img/4.png" alt="&#x7C7B;&#x8DEF;&#x5F84;&#x56FE;"></p>
<h3 class="mume-header" id="1&#x589E;&#x52A0;&#x4EE3;&#x7406;&#x63A5;&#x53E3;-studentdaojava">①：增加代理接口： studentdao.java</h3>

<pre class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dao<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>Student<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">studentdao</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">/*
	 * mybatis的代理接口，
	 * 1.是一个接口，并且接口的全类名，必须是映射文件的命名空间的值
	 * 2.接口的方法名与映射文件的SQL语句的id值一一对应。
	 * 3.方法的参数，也与SQL语句的的参数一一对应。
	 * */</span>
	
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertStudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteStudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateStudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> Student <span class="token function">selectStudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Student<span class="token operator">></span> <span class="token function">selectAllStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>

</pre>
<h3 class="mume-header" id="2&#x4FEE;&#x6539;&#x6620;&#x5C04;&#x6587;&#x4EF6;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;&#x7684;&#x503C;-studentmapperxml-&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;">②：修改映射文件的命名空间的值---studentMapper.xml 的命名空间：</h3>

<pre class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token doctype">&lt;!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"></span>

<span class="token comment" spellcheck="true">&lt;!-- 为mapper指定唯一的命名空间，在不用接口式编程的情况下，随便取名,用接口式编程的情况时，应该为代理接口的全类名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.studentdao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
......

</pre>
<h3 class="mume-header" id="3&#x6D4B;&#x8BD5;&#x7C7B;-mainjava">③测试类 ，main.java</h3>

<pre class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>test<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Resources<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSession<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSessionFactory<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span>SqlSessionFactoryBuilder<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>studentdao<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>Student<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">main</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">/*
		 * 1.通过输入流来读取mybatis的配置文件信息。告诉程序连接的数据库，用户名，密码。以及到哪里去寻找 持久化类与数据表的映射文件
		 * 2.通过xml配置文件信息，初始化mybatis ， 创建SqlSessionFactory
		 * 3.通过SqlSessionFactory，实例化session 对象
		 * 4.: 通过session对象，用反射的方式，获取代理接口的实例化对象。
		 * 5.创建你要操作的数据对象
		 * 6.用代理接口的方法，实现对数据库的CRUD
		 * 
		 * */</span>
		
		
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
	<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		studentdao studao<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>studentdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		
		Student stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
<span class="token comment" spellcheck="true">//		int a=studao.insertStudent(stu);</span>
<span class="token comment" spellcheck="true">//		System.out.println(a);</span>
<span class="token comment" spellcheck="true">//		session.commit();            //提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		stu<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               
		stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		studao<span class="token punctuation">.</span><span class="token function">updateStudent</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//修改数据要知道id</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		Student sa<span class="token operator">=</span>studao<span class="token punctuation">.</span><span class="token function">selectStudent</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sa<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token keyword">int</span> asc<span class="token operator">=</span>studao<span class="token punctuation">.</span><span class="token function">deleteStudent</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>asc<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//提交到数据库，查询数据不用提交,对数据库的数据不修改的话，不用提交</span>
		
		session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre>
<h2 class="mume-header" id="font-colorredresultmap&#x6CE8;&#x91CA;&#x5F88;&#x91CD;&#x8981;font"><font color="red">ResultMap（注释很重要）</font>:</h2>

<h3 class="mume-header" id="1resultmap&#x7684;&#x4F5C;&#x7528;&#x6982;&#x8FF0;">1.ResultMap的作用概述：</h3>

<p>  MyBatis中在查询进行select映射的时候，返回类型可以用resultType，也可以用resultMap，resultType是直接表示返回类型的，而resultMap则是对外部ResultMap的引用（<font color="red">相当于自定义结果集映射规则</font>），但是<strong>resultType跟resultMap不能同时存在</strong>。</p>
<p>  在MyBatis进行查询映射时,<font color="blue">由于Mybatis的底层是JDBC，其实查询出来的每一个属性都是放在一个对应的Map里面的，其中键是属性名，值则是其对应的值。</font></p>
<p>  ①当提供的返回类型属性是resultType时，<font color="red">MyBatis会将Map里面的键值对取出赋给resultType所指定的对象对应的属性。所以其实MyBatis的每一个查询映射的返回类型都是ResultMap，只是当提供的返回类型属性是resultType的时候，MyBatis对自动的给把对应的值赋给resultType所指定对象的属性。</font><br>
  ②当提供的返回类型是resultMap时，因为Map不能很好表示领域模型，就需要自己再进一步的把它转化为对应的对象，这常常在复杂查询中很有作用<font color="green">(需要程序员自定义结果集映射规则，手动的把查询的结果一个一个转化为想要对应的对象)</font>。</p>
<h3 class="mume-header" id="2&#x82E5;&#x8868;&#x7684;&#x5217;&#x540D;&#x4E0E;&#x6301;&#x4E45;&#x5316;&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#x540D;&#x4E0D;&#x76F8;&#x540C;&#x53EF;&#x7528;resultmap&#x89E3;&#x51B3;">2.若表的列名与持久化类的属性名不相同，可用ResultMap解决：</h3>

<p><font color="red">这段代码中，student表的列名为 sid,sname,sage,而持久化类(实体类)的属性为 id, name,age</font></p>
<p>studentMapper.xml</p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectStudentByid<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		select * where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--resultMap 的 id值与 select标签的resultMap的值相同,表明这两个标签互相联系--></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  <span class="token comment" spellcheck="true">&lt;!-- id 标签指的是该列为主键列，result标签代表普通列--></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sage<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

</pre>
<h3 class="mume-header" id="3&#x4E00;&#x5BF9;&#x4E00;&#x5173;&#x8054;&#x67E5;&#x8BE2;association&#x6807;&#x7B7E;">3.一对一关联查询（association标签）：</h3>

<p>参考链接：<br>
<a href="http://blog.csdn.net/lee4037/article/details/16798941">MyBatis两张表字段名相同产生的问题</a></p>
<p>  生活中有许多涉及到一对一关联查询的例子，例如，<font color="red">把学生作为中心，一个学生只能有一个班级。查询某个学生时，把他所在的班级也查出来。</font></p>
<ol>
<li>
<p>增加school_class表：<br>
<img src="../img/mybatis_img/5.png" alt="School_class&#x8868;"></p>
</li>
<li>
<p>修改student表（<font color="red">增加class_id 列,class_id 列与school_class的id列 对应。没有设置外键<font>）:<br>
<img src="../img/mybatis_img/6.png" alt="School_class&#x8868;"><br>
2.5，修改Student的javaBean：</font></font></p>
</li>
</ol>
<pre class="language-java"><span class="token keyword">private</span> School_class sclass<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//这个字段用来表示学生的班级,其对应的列名为class_id</span>

<span class="token keyword">public</span> School_class <span class="token function">getSclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> sclass<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSclass</span><span class="token punctuation">(</span>School_class sclass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>sclass <span class="token operator">=</span> sclass<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">"Student [id="</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">", name="</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">", age="</span> <span class="token operator">+</span> age
				<span class="token operator">+</span> <span class="token string">", sclass="</span> <span class="token operator">+</span> sclass <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</pre>
<ol start="3">
<li>
<p>编写School_class的javaBean对象，这个对应school_class表的持久化类，</p>
</li>
<li>
<p>在StudentMapper的映射文件中使用ResultMap：<br>
  <font color="red">执行select标签时，会根据与其相联系的resultMap 标签来进行结果集映射</font><br>
<strong>有三种方法：</strong></p>
</li>
</ol>
<p>数据库中执行sql语句：<br>
<img src="../img/mybatis_img/10.png" alt="&#x8FD0;&#x884C;&#x622A;&#x56FE;"><br>
<img src="../img/mybatis_img/11.png" alt="&#x8FD0;&#x884C;&#x622A;&#x56FE;"></p>
<p><font color="red">①不使用association标签，使用级联属性封装结果集</font><br>
StudentMapper.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectStudent<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select_gai<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	SELECT s.*,sc.id scid,sc.name scname from student s LEFT JOIN 
	
	school_class sc on s.class_id=sc.id where 1=1 
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select_gai<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!--property="sclass.id"表示Student的sclass属性的id属性，把查询出来的scid的列的值，赋值给它  --></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
 	
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
</pre>
<p><font color="red">②：association 使用别名（嵌套查询）</font></p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectStudent<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	SELECT s.*,sc.id scid,sc.name scname from student s LEFT JOIN 
	
<span class="token comment" spellcheck="true">&lt;!--这里的sql语句使用了 left join...on..关联查询，，scid 是sid的别名，scname是sc.name的别名，s 是student表的别名，sc 是school——class的别名--></span>

	school_class sc on s.class_id=sc.id where 1=1 
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--resultMap 的 id值与 select标签的resultMap的值相同,表明这两个标签互相联系--></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
 	
 <span class="token comment" spellcheck="true">&lt;!-- association 用来指定联合的javaBean对象，
 property="sclass"告诉标签那个属性是联合的对象
 javaType 表示联合的对象的类型，不能省略。
 
 association标签内的id,result标签，表示查询出来的列名的值，放到联合对象的那个属性中
  --></span>	
 	
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	 <span class="token comment" spellcheck="true">&lt;!--查询出来的列名scid 的值，放到联合对象的id属性中  --></span>
	 <span class="token comment" spellcheck="true">&lt;!--scid 是sid的别名，scname是sc.name的别名--></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>association</span><span class="token punctuation">></span></span> 
	
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

</pre>
<p><font color="red">③：association 分步查询（在sql语句执行时，在执行另一个sql语句）</font></p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectStudent2<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select2<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	SELECT s.*,sc.id scid,sc.name scname from student s LEFT JOIN 
	school_class sc on s.class_id=sc.id where 1=1 
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and s.name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_one_select2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!--association标签中
		使用select指定的方法（传入column指定的列的参数的值），查询出来的结果，封装给property 指定的对象中
	
	--></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>class_id<span class="token punctuation">"</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
 <span class="token comment" spellcheck="true">&lt;!--select的值，表示执行一条sql语句，select的值指向id为select属性值的select标签。并把执行sql语句的结果，封装到property 代表的对象中。--></span>
  	
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
</pre>
<p>School_classMapper.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>


</pre>
<ol start="5">
<li>测试：</li>
</ol>
<p>main.java:</p>
<pre class="language-java">		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
		<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		studentdao studao<span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>studentdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Student stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"xiao"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Student s <span class="token operator">=</span> studao<span class="token punctuation">.</span><span class="token function">selectStudent</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//selectStudent为代理接口（studentdao）的动态查询数据的方法。</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">getSclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</pre>
<ol start="6">
<li>结果截图：<br>
<img src="../img/mybatis_img/7.png" alt="&#x7ED3;&#x679C;&#x622A;&#x56FE;"></li>
</ol>
<h3 class="mume-header" id="4&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x67E5;&#x8BE2;collection&#x6807;&#x7B7E;">4.一对多关联查询（collection标签）：</h3>

<p>参考链接：<br>
<a href="http://blog.csdn.net/xzm_rainbow/article/details/15336933">一对多表关系详解</a></p>
<p>  生活中，如果以班级为中心的话,<font color="red">一个班级可以有多个学生，这相当与一对多的关系。查询某个班级时，把班级所在的多个学生也查询出来。</font></p>
<ol>
<li>添加代码，School_class 的javaBean</li>
</ol>
<pre class="language-java"><span class="token keyword">private</span> List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stulist<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//一个班可以有多个学生，使用list集合</span>

<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Student<span class="token operator">></span> <span class="token function">getStulist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> stulist<span class="token punctuation">;</span>
<span class="token punctuation">}</span>	
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStulist</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stulist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>stulist <span class="token operator">=</span> stulist<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> String <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">"School_class [id="</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">", name="</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">", stulist="</span><span class="token operator">+</span> stulist <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
<ol start="2">
<li>添加代码到mybatis的配置文件：</li>
</ol>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/studentMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/School_classMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>
</pre>
<ol start="3">
<li>添加代码，到School_classMapper.xml(<strong>这里有两种写法，①使用嵌套查询，②使用分部查询</strong>)</li>
</ol>
<p><strong>①：嵌套查询</strong><br>
<strong>测试sql语句：</strong><br>
<img src="../img/mybatis_img/8.png" alt="sql&#x8BED;&#x53E5;"><br>
<img src="../img/mybatis_img/9.png" alt="&#x67E5;&#x8BE2;&#x7ED3;&#x679C;"></p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.School_classdao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--#{id}:从传递过来的参数取出id值--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectclass_stu<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
select sc.* ,s.id sid,s.name sname, s.age sage, s.class_id scid from 
school_class sc LEFT JOIN student s on sc.id=s.class_id where 1=1
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> id!<span class="token punctuation">=</span>null <span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and sc.id=#{id}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 这段表示，如果传来的参数中的id 不为null，则参数的id的值赋值给sql语句的sc.id --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> name!<span class="token punctuation">=</span>null <span class="token punctuation">"</span></span><span class="token punctuation">></span></span>and sc.name=#{name}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!-- 这段表示，把查询出来的id列的值赋值给School_class的id属性 --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stulist<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
	<span class="token comment" spellcheck="true">&lt;!-- ofType:表示集合当中的类型，本例子为Student类型，sid在sql语句中为s.id的别名 ，--></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 这段表示，把查询出来的sid列的值赋值给Student的id属性 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sage<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 这段表示，查询出来的scid列的值，赋值给Student的sclass属性的id字段 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
</pre>
<p><strong>②分布查询：</strong></p>
<pre class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- 一对多关联查询的分布查询 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectclass_stu2<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_more_aprat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from school_class where id=#{id}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_more_aprat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stulist<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectstudent<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!-- 
		执行select="selectstudent"的sql语句，(把column的值当做参数)，
		查询的结果封装到property="stulist"的属性中。
	 --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>


<span class="token comment" spellcheck="true">&lt;!--id="selectstudent" 的select查询，应该写在StudentMapper.xml中,这里是为了方便  --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectstudent<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	select * from student where class_id=#{id}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

</pre>
<ol start="4">
<li>测试(以嵌套查询为例)：</li>
</ol>
<pre class="language-java"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
School_classdao mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>School_classdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
School_class sc<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">School_class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sc<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
School_class selectclass_stu <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">selectclass_stu</span><span class="token punctuation">(</span>sc<span class="token punctuation">)</span><span class="token punctuation">;</span>
System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>selectclass_stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p><strong>运行结果：</strong><br>
School_class [id=1, name=A, stulist=[Student [id=5,name=xiao, age=12, sclass=School_class [id=1, name=null,stulist=null]]]]</p>
<h3 class="mume-header" id="5&#x591A;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x67E5;&#x8BE2;">5.多对多关联查询：</h3>

<p>参考链接：<br>
<a href="https://www.cnblogs.com/hnlictmso/p/6363277.html">Mybatis多对多关联查询</a></p>
<p>  生活中，如果以班级与老师的关系的话,<font color="red">一个班级可以有多个老师，一个老师可以教多个班级，这就是多对多的关系。①查询某个班级时，把班级所在的多个老师也查询出来。②查询某个老师时，把老师所在的多个班级也查询出来。③把老师全查询出来时，把所以老师的所教的班级都查询出来。</font><br>
  <strong>一般进行多对多的关联查询，要用到中间表（存放两表达的公共信息，如id，通过公共信息，使得两表产生连接）</strong></p>
<ol>
<li>
<p>创建老师表：teacher<br>
<img src="../img/mybatis_img/13.png" alt="&#x8001;&#x5E08;&#x8868;"></p>
</li>
<li>
<p>编写老师表的持久化类（javaBean）,代理接口（方法名与映射文件的id值相同）<br>
<img src="../img/mybatis_img/14.png" alt=""></p>
</li>
<li>
<p>添加TeacherMapper.xml到mybatis的配置文件中:</p>
</li>
</ol>
<pre class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- mappers标签告诉mybatis去哪里找sql（持久化类的）映射文件 --></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/studentMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/School_classMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/TeacherMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>
</pre>
<ol start="4">
<li>
<p>修改School_class表的持久化类，代理接口：<br>
<img src="../img/mybatis_img/15.png" alt=""></p>
</li>
<li>
<p>创建中间表：class_teacher（不用编写其javaBean与代理接口）<br>
<img src="../img/mybatis_img/12.png" alt="&#x4E2D;&#x95F4;&#x8868;"></p>
</li>
</ol>
<h4 class="mume-header" id="1&#x67E5;&#x8BE2;&#x67D0;&#x4E2A;&#x73ED;&#x7EA7;&#x65F6;&#x628A;&#x73ED;&#x7EA7;&#x6240;&#x5728;&#x7684;&#x591A;&#x4E2A;&#x8001;&#x5E08;&#x4E5F;&#x67E5;&#x8BE2;&#x51FA;&#x6765;">①查询某个班级时，把班级所在的多个老师也查询出来：</h4>

<p><img src="../img/mybatis_img/16.png" alt=""></p>
<p>School_classMapper.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select_class_tescher<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
SELECT sc.id,sc.name,t.id tid,t.name tname 
from school_class sc,teacher t,class_teacher ct 
where ct.c_id=sc.id and ct.t_id=t.id and sc.id=#{id};

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- tid 是t.id的别名，tname是t.name的别名，ct 是中间表class_teacher的别名， --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 把结果的name列的值赋值给School_class的name属性 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tealist<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Teacher<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
			<span class="token comment" spellcheck="true">&lt;!-- 把结果的tname列的值赋值给School_class的tealist属性的name字段 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

</pre>
<p>测试 main.java:</p>
<pre class="language-java"><span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		  SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
		<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		School_classdao scdao <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>School_classdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		School_class sc<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">School_class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sc<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		School_class selectclass_stu <span class="token operator">=</span> scdao<span class="token punctuation">.</span><span class="token function">select_class_tescher</span><span class="token punctuation">(</span>sc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//代理接口的方法与对应的xml映射文件的CRUD标签的id值相同。</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>selectclass_stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
</pre>
<p>测试结果：<br>
School_class [id=1, name=A, stulist=null, tealist=[Teacher [id=1, name=tom, stulist=null, sclass=null], Teacher [id=2, name=jim, stulist=null, sclass=null]]]</p>
<h4 class="mume-header" id="2&#x67E5;&#x8BE2;&#x67D0;&#x4E2A;&#x8001;&#x5E08;&#x65F6;&#x628A;&#x8001;&#x5E08;&#x6240;&#x5728;&#x7684;&#x591A;&#x4E2A;&#x73ED;&#x7EA7;&#x4E5F;&#x67E5;&#x8BE2;&#x51FA;&#x6765;">②查询某个老师时，把老师所在的多个班级也查询出来：</h4>

<p><img src="../img/mybatis_img/17.png" alt=""></p>
<p>TeacherMapper.xml</p>
<pre class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- 为mapper指定唯一的命名空间，在不用接口式编程的情况下，随便取名 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao.Teacherdao<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">&lt;!--#{id}:从传递过来的参数取出id值--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select_teacher_class<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
SELECT t.id,t.name,sc.id scid ,sc.name scname from 
teacher t,school_class sc ,class_teacher ct 
where t.id=ct.t_id and ct.c_id=sc.id and t.id=#{id};

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Teacher<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
</pre>
<p>测试代码 main.java:</p>
<pre class="language-java"><span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		  SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
		<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		Teacherdao mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>Teacherdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Teacher t<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		t<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Teacher select_teacher_class <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">select_teacher_class</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//代理接口的方法与对应的xml映射文件的CRUD标签的id值相同。</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>select_teacher_class<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
</pre>
<p>测试结果：<br>
Teacher [id=1, name=tom, stulist=null, sclass=[School_class [id=1, name=A, stulist=null, tealist=null], School_class [id=2, name=B, stulist=null, tealist=null], School_class [id=3, name=C, stulist=null, tealist=null]]]</p>
<h4 class="mume-header" id="3&#x628A;&#x67E5;&#x8BE2;&#x5168;&#x90E8;&#x8001;&#x5E08;&#x7684;&#x540C;&#x65F6;&#x628A;&#x6240;&#x6709;&#x8001;&#x5E08;&#x7684;&#x6240;&#x6559;&#x7684;&#x73ED;&#x7EA7;&#x90FD;&#x67E5;&#x8BE2;&#x51FA;&#x6765;">③把查询全部老师的同时，把所有老师的所教的班级都查询出来：</h4>

<p><img src="../img/mybatis_img/18.png" alt=""></p>
<p>TeacherMapper.xml:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select_teacher_class2<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
SELECT t.id,t.name,sc.id scid ,sc.name scname from 
teacher t,school_class sc ,class_teacher ct 
where t.id=ct.t_id and ct.c_id=sc.id ;

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Teacher<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>more_to_more2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token comment" spellcheck="true">&lt;!-- 把查询出来的的name列的值赋值给Teacher类的name属性 --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 把查询出来的的scname列的值赋值给Teacher类sclass属性的name字段 --></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>

</pre>
<p>测试代码：</p>
<pre class="language-java"><span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		  SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
		<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		Teacherdao mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>Teacherdao<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Teacher t<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Teacher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		t<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		List<span class="token operator">&lt;</span>Teacher<span class="token operator">></span> select_teacher_class <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">select_teacher_class2</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>select_teacher_class<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
</pre>
<p>测试结果：<br>
[Teacher [id=1, name=tom, stulist=null, sclass=[School_class [id=1, name=A, stulist=null, tealist=null], School_class [id=2, name=B, stulist=null, tealist=null], School_class [id=3, name=C, stulist=null, tealist=null]]], Teacher [id=2, name=jim, stulist=null, sclass=[School_class [id=1, name=A, stulist=null, tealist=null], School_class [id=3, name=C, stulist=null, tealist=null]]], Teacher [id=3, name=jack, stulist=null, sclass=[School_class [id=4, name=D, stulist=null, tealist=null]]]]</p>
<h3 class="mume-header" id="6&#x5173;&#x8054;&#x67E5;&#x8BE2;&#x8865;&#x5145;">6.关联查询补充：</h3>

<h4 class="mume-header" id="1&#x61D2;&#x52A0;&#x8F7D;&#x5EF6;&#x8FDF;&#x52A0;&#x8F7D;">1.懒加载（延迟加载）：</h4>

<p>  resultMap可实现高级映射（使用association、collection实现一对一及一对多映射），association、collection具备延迟加载功能。<br>
  如果查询订单并且关联查询用户信息。如果先查询订单信息即可满足要求，当我们需要查询用户信息时再查询用户信息。把对用户信息的按需去查询就是延迟加载。<strong>白话文：不会立即发送sql语句去查询用户信息，而是等到要用用户信息时，才会发送sql语句查询订单对应的用户信息。</strong><br>
<font color="red">延迟加载：先从单表查询，需要时再从关联表去关联查询，大大提高数据库性能，因为查询单表要比关联查询多张表速度要快。</font></p>
<p>  <strong>在实际开发中，一对多关系通常映射为集合对象，而由于多的一方的数据量可能很大，所以通常使用懒加载；而多对一只是关联到一个对象，所以通常使用多表连接，直接把数据提取出来即可。</strong></p>
<p>School_classMapper.xml</p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>one_to_more<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stulist<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Student<span class="token punctuation">"</span></span> <span class="token attr-name">fetchType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lazy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
	<span class="token comment" spellcheck="true">&lt;!--fetchType="lazy" ,fetchType的取值有eager，lazy，
	eager：表示立即加载。
	lazy：表示懒加载。

	注意：当使用fetchType="lazy" 时，使用懒加载时，要在mybatis的配置文件中增加配置：

	
	--></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sage<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scid<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 这段表示，查询出来的scid列的值，赋值给Student的sclass属性的id字段 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass.name<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sname<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
</pre>
<p>mybatis_config.xml:</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
		<span class="token comment" spellcheck="true">&lt;!-- 使用懒加载生效，必须配置的属性
		lazyLoadingEnabled：表示懒加载的的全局开关，所有的关联对象，都会懒加载，默认为false。
		lazyLoadingEnabled：开启时，会使带有懒加载属性的对象立即加载；反之，每种属性都会按需加载，默认为true
		
		 --></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>lazyLoadingEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>aggressiveLazyLoading<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>	 
</pre>
<h4 class="mume-header" id="2&#x4F7F;&#x7528;associationcollection-&#x6807;&#x7B7E;&#x8FDB;&#x884C;&#x5206;&#x5E03;&#x67E5;&#x8BE2;&#x65F6;&#x53EF;&#x4EE5;&#x4F20;&#x591A;&#x5217;&#x7684;&#x503C;">2.使用association，collection 标签进行分布查询时，可以传多列的值：</h4>

<p>注意：<font color="red">需要把多列的值封装为map，传过去</font>：<br>
  column=&quot;{key1=column1,key2=column2,...}&quot;</p>
<pre class="language-xml">
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>association</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sclass<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{id<span class="token punctuation">=</span>class_id}<span class="token punctuation">"</span></span> <span class="token attr-name">javaType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.School_class<span class="token punctuation">"</span></span> <span class="token attr-name">select</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>selectClass<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>

</pre>
<h4 class="mume-header" id="3mybatis&#x7684;&#x9274;&#x522B;&#x5668;discriminator">3.MyBatis的鉴别器（discriminator）:</h4>

<p>  使用鉴别器，进行分段查询时，根据表中某个字段区别数据，根据查询的结果，选择不同的封装结果集的规则，将查询出的数据自动封装成不同类型的对象（选择不同的分段查询，类似switch）。<br>
参考链接：<br>
<a href="http://blog.csdn.net/ykzhen2015/article/details/51249963">MyBatis鉴别器</a></p>
<h2 class="mume-header" id="&#x52A8;&#x6001;sql">动态SQL:</h2>

<p>  Mybatis的动态sql是基于OGNL的表达式来完成的，OGNL表达式可以被用在任意的sql映射语句中。<br>
常用的动态SQL元素：</p>
<ol>
<li>if 语句 (简单的条件判断)</li>
<li>choose (when,otherwize) ,相当于java 语言中的 switch ,与 jstl 中的choose 很类似.</li>
<li>trim (对包含的内容加上 prefix,或者 suffix 等，前缀，后缀)</li>
<li>where (主要是用来简化sql语句中where条件判断的，能智能的处理 and , or ,不必担心多余导致语法错误)</li>
<li>set (主要用于更新时)</li>
<li>foreach (在实现 mybatis in 语句查询时特别有用)</li>
<li>bind</li>
<li>sql标签；</li>
</ol>
<p>参考链接：<br>
<a href="https://baike.baidu.com/item/OGNL/10365326?fr=aladdin">OGNL</a></p>
<h3 class="mume-header" id="1if-&#x8BED;&#x53E5;-&#x7B80;&#x5355;&#x7684;&#x6761;&#x4EF6;&#x5224;&#x65AD;">1.if 语句 (简单的条件判断)：</h3>

<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select1<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
  select * from User Where 1=1  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span> null and phone !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    and name like #{name} and phone = #{phone} 
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    and gender = #{gender}  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
....
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>  
</pre>
<h3 class="mume-header" id="2choose-whenotherwize&#x8BED;&#x53E5;">2.choose (when,otherwize)语句：</h3>

<p><font color="red">如果传入了id,就根据id查询，没有传入id，就根据name查询，否则就根据 gender=&quot;男&quot; 查询。<font color="red">只会进入其中一个分支（条件）去查询</font>。<strong>例如传入了id，name，还是按id查询。</strong></font></p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select2<span class="token punctuation">"</span></span>  <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Student<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
  select * from student Where 1=1   

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>choose</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
      AND id =#{id}  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>when</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
      AND name =#{name}  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>when</span><span class="token punctuation">></span></span>    

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>otherwise</span><span class="token punctuation">></span></span>  
      	AND gender="男"  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>otherwise</span><span class="token punctuation">></span></span>  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>choose</span><span class="token punctuation">></span></span>  

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>   
</pre>
<h3 class="mume-header" id="3trim&#x6807;&#x7B7E;&#x5E38;&#x7528;&#x4E09;&#x79CD;&#x7528;&#x6CD5;">3.trim标签（常用，三种用法）</h3>

<ol>
<li>第一种用法：</li>
</ol>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select2<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
select * from user 
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>where<span class="token punctuation">"</span></span> <span class="token attr-name">prefixoverride</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>AND | OR<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

　　	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 	
		AND name=#{name}
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>

　　	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 		AND gender=#{gender}
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
</pre>
<p><font color="red">假如说name和gender的值都不为null的话.打印的SQL为：<br>
  select * from user where name = 'xx' and gender = 'xx'<br>
在where 与name 之间是不存在第一个and的，上面两个属性的意思如下：<br>
  prefix：前缀　　　　　　<br>
  prefixoverride：去掉第一个and或者是or<br>
</font></p>
<ol start="2">
<li>第二种用法：</li>
</ol>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>update2<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	update user

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>set<span class="token punctuation">"</span></span> <span class="token attr-name">suffixoverride</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> where id <span class="token punctuation">=</span> #{id} <span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 	name=#{name} ,
 	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
	gender=#{gender} ,  
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>
</pre>
<p><font color="red">假如说name和gender的值都不为null的话打印的SQL为：<br>
update user set name='xx' , gender='xx'    where id='x'<br>
在gender='xx' 与where 的地方不存在逗号，而且自动加了一个set前缀和where后缀，上面三个属性的意义如下，<br>
  prefix：前缀。<br>
  suffixoverride：去掉最后一个逗号（也可以是其他的标记，就像是上面前缀中的and一样）<br>
  suffix：后缀.可直接写在sql语句末尾。<br>
</font></p>
<ol start="3">
<li>第三种方法：</li>
</ol>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>insertGoods<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.Goods<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>         
insert into goods
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>name !<span class="token punctuation">=</span> null and name !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
             name,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>price !<span class="token punctuation">=</span> null and price !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
             price,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>introduce !<span class="token punctuation">=</span> null and introduce !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
             introduce,
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trim</span> <span class="token attr-name">prefix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>values (<span class="token punctuation">"</span></span> <span class="token attr-name">suffix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span> <span class="token attr-name">suffixOverrides</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
		
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>name !<span class="token punctuation">=</span> null and name !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
            		 #{name},
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>price !<span class="token punctuation">=</span> null and price !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
		              #{price},
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>introduce !<span class="token punctuation">=</span> null and introduce !<span class="token punctuation">=</span> <span class="token punctuation">"</span><span class="token punctuation">"</span> <span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
		              #{introduce},
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
		
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trim</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>
</pre>
<p><strong>如果if的条件都符合的话,sql语句：<br>
insert into goods（ name, price, introduce）values （ 'xx' , 'xx', 'xx' ）<br>
</strong></p>
<h3 class="mume-header" id="4where">4.where</h3>

<p>  where 元素知道在有一个及一个以上的if语句成立的情况下，才去插入where子句，而且若最后的内容为 and 或 or 开头，则where元素会将其去除。</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select3<span class="token punctuation">"</span></span>  <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
  SELECT * FROM User  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">></span></span>  
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>age !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    age = #{age}  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    and name like #{name}  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>where</span><span class="token punctuation">></span></span> 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>  
</pre>
<p>若没有传入 age ,它会自动清除最近内容的and或者or，SQL语句为：<font color="red"><br>
SELECT * FROM User  where  name like #{name}  </font></p>
<h3 class="mume-header" id="5set&#x8BED;&#x53E5;&#x9002;&#x7528;&#x4E0E;&#x52A8;&#x6001;&#x66F4;&#x65B0;">5.set语句（适用与动态更新）：</h3>

<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>update1<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
  update User  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	  username=#{username},
	  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password !<span class="token punctuation">=</span>null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	  password=#{password},
	  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Age !<span class="token punctuation">=</span> null<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	  Age =#{Age}
	  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">></span></span>  
  where id=#{id}  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>  
</pre>
<p>set 元素会前置set 关键字，同时会消除多出来的无关的逗号。sql语句：<font color="red"><br>
update user  set  username=#{username},password=#{password}, Age =#{Age}  where id=#{id}  </font></p>
<h3 class="mume-header" id="6foreach&#x8BED;&#x53E5;">6.foreach语句：</h3>

<p>  关于动态sql的另一个常用的操作就是对集合进行遍历，通常发生在构建 in 条件语句时。<br>
  <font color="red">foreach 的元素功能非常强大。它允许指定一个集合，声明可以用在元素体内的集合项和索引变量。它也允许指定开闭匹配的字符串以及在迭代中间放置分隔符。</font></p>
<p><strong>foreach 标签中：</strong></p>
<p><font color="red">collection</font> ：指定要遍历的集合，list类型的会特殊处理封装在map中，map的key就叫list。</p>
<p><font color="red">item</font> ：把当前遍历的元素赋值给指定的变量</p>
<p><font color="red">separator </font>：每个元素之间的分隔符。</p>
<p><font color="red">open</font>：遍历条件中，以什么符号开始的。</p>
<p><font color="red">close</font>：遍历条件中，以什么符号结束的。</p>
<p><font color="red">index</font>：遍历list时，index表示为索引，item是当前值。遍历map时，index表示为map的key，item为map的value。</p>
<p><font color="red">&quot;#{item_ids}&quot;</font>: item_ids是变量名，表示取出变量的值，也就是当前遍历出的元素。</p>
<p><strong>1. 批量查询：</strong></p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select5<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
    select * from User where id in  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item_ids<span class="token punctuation">"</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  
        #{item_ids}  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">></span></span>  
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>  
    
</pre>
<pre class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token function">select5</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//给这个sql语句传入一个集合，集合的每个元素都为id </span>
</pre>
<p>SQL语句(一个？表示一个id)：<br>
<font color="red">select * from User where id in （?,?,....）</font></p>
<p><strong>2. 批量插入数据：</strong><br>
mysql支持<font color="red"> insert into tbale_name() values (),(),(),...这种语法</font></p>
<p>Studentdao.java</p>
<pre class="language-java">	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addstulist</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Student<span class="token operator">></span> stulist<span class="token punctuation">)</span><span class="token punctuation">;</span>

</pre>
<p>StudentMapper.xml</p>
<pre class="language-xml">	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addstulist<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
		insert into student (id,name,gender) values
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stulist<span class="token punctuation">"</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>,<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
	    	(#{stulist.id},#{stulist.name},#{stulist.gender})
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>
</pre>
<p>SQL语句(一个？表示一个id)：</p>
<p><font color="red">insert into student(id,name,gender) values (?,?,?) ,(?,?,?)...</font></p>
<h3 class="mume-header" id="7bind&#x8BED;&#x53E5;&#x6211;&#x4E5F;&#x4E0D;&#x592A;&#x4F1A;">7.bind语句(我也不太会)：</h3>

<p>  bind元素可以从OGNL表达式中创建一个变量并将其绑定到上下文中。</p>
<p>bind元素允许你在自定义变量（不用符合OGNL规范），并且应用到上下文中。把OGNL表达式的值绑定到一个变量中，方便后来引用这个变量。<br>
例如：</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>select_bind<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.entity.user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bind</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">'</span>%<span class="token punctuation">'</span> + name + <span class="token punctuation">'</span>%<span class="token punctuation">'</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  SELECT * FROM user
  WHERE name LIKE #{name}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
</pre>
<p>bind标签：<br>
name=&quot;name&quot; :被绑定的属性，变量。<br>
value=&quot;'%' + _parameter.getName() + '%'&quot; ：对被绑定的属性，变量，左右增加'%'。</p>
<p><font color="red">以后传入的参数的name属性在sql语句中都会左右加上'%',这样就变成了根据 name 进行模糊查询。</font></p>
<pre class="language-java"> user us<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 us<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"o"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 userdao<span class="token punctuation">.</span><span class="token function">select_bind</span><span class="token punctuation">(</span>us<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</pre>
<p>SQL语句：<br>
<font color="red"> SELECT * FROM user WHERE name LIKE '%o%' </font></p>
<h3 class="mume-header" id="8sqlinclude-&#x6807;&#x7B7E;&#x62BD;&#x53D6;&#x53EF;&#x91CD;&#x590D;&#x4F7F;&#x7528;&#x7684;sql&#x7247;&#x6BB5;&#x65B9;&#x4FBF;&#x5F15;&#x7528;">8.sql，include 标签（抽取可重复使用的sql片段，方便引用）：</h3>

<p>sql标签  :抽取sql片段。<br>
inculde标签  :引用被抽取的sql片段。</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addstulist<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 insert into student (id,name,gender) values (#{id},#{name},#{gender});
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sql</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sql_1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  id,name,gender
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sql</span><span class="token punctuation">></span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addstulist<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 insert into student (  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sql_1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>  ) values (#{id},#{name},#{gender});
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>

</pre>
<h2 class="mume-header" id="mybatis&#x7684;&#x7F13;&#x5B58;&#x673A;&#x5236;">Mybatis的缓存机制：</h2>

<p>  在大型项目开发，由于涉及到的表多，数据量大，通常对数据库查询的性能要求很高。Mybatis提供了<font color="red">查询缓存机制，用于缓存查询出来的数据，减轻数据库的压力。从而提高数据库的查询性能。</font><br>
  Mybatis的查询缓存分为：<font color="blue">一级缓存（SqlSession 级别的缓存），二级缓存（mapper 级别的缓存）</font>。其中，二级缓存是多个SqlSession 共享的。</p>
<h3 class="mume-header" id="&#x4E00;&#x7EA7;&#x7F13;&#x5B58;sqlsession-&#x7EA7;&#x522B;">一级缓存（SqlSession 级别）：</h3>

<p>  <font color="blue">Mybatis默认开启一级缓存，不需要进行任何配置。</font><br>
在之前的例子中可以知道，操作数据库之前，需要以下几步：</p>
<blockquote>
<p>1.通过输入流来读取mybatis的配置文件信息。告诉程序连接的数据库，用户名，密码。以及到哪里去寻找 持久化类与数据表的映射文件<br>
2.通过xml配置文件信息，初始化mybatis ， 创建SqlSessionFactory<br>
3.通过SqlSessionFactory，实例化session 对象<br>
4.创建你要操作的数据对象<br>
5.找到Mapper映射文件的对应的sql语句，通过映射文件袋命名空间+对应SQL语句的id ，例如：&quot;com.dao.StudentMapper.insertStudent&quot;<br>
6.对操作对象实行CRUD 方法</p>
</blockquote>
<p>其中第三步，通过<font color="red">SqlSessionFactory，实例化session 对象</font>。<font color="blue">当我们构造session 对象时，在对象中会产生一个 HashMap 用于存储缓存数据</font>。<strong>不同的 SqlSession 之间的缓存数据区域（HashMap）是互相不影响的。</strong></p>
<p>一级缓存原理及实现过程：<br>
  由于以及一级缓存的作用域是 SqlSession级别的，<mark>当同一个SqlSession中执行两次相同的sql语句时，第一次执行sql完毕，会把查询的数据写到缓存（内存）中。当第二次执行相同的sql 查询语句时，会直接从缓存中获取查询数据。不会去底层数据库中进行查询</mark>。从而减轻了数据库的压力，提高了查询效率。</p>
<p><font color="red">注意：</font><br>
①：如果SqlSession 执行了对数据库的数据进行了修改（如：update，insert，delete）等sql语句，并提交到数据库时。该SqlSession的一级缓存会被清空，保证缓存中的数据是最新的。<br>
②：Mybatis的缓存机制是基于 id 进行缓存的，当HashMap缓存数据时，是使用对象的id，作为key，而对象作为 value 保存的。</p>
<p><mark>当一个SqlSession关闭后，其缓存消失。</mark></p>
<h3 class="mume-header" id="&#x4E8C;&#x7EA7;&#x7F13;&#x5B58;mapper-&#x7EA7;&#x522B;">二级缓存（mapper 级别）：</h3>

<p>  <font color="blue">Mybatis默认没有开启二级缓存，需要在Mybatis的配置文件中setting 全局参数中配置开启二级缓存。</font></p>
<p>二级缓存原理及实现过程：<br>
  在上面的操纵数据库的过程中的第五步中，我们需要通过操作Mapper映射文件的sql语句，实现CRUD操作。由于二级缓存是mapper级别的缓存，<mark>当多个不同 SqlSession 使用同一个Mapper的sql 语句去操作数据库时，查询的数据会存在二级缓存区域，该区域同样是由HashMap 进行数据存储。多个不同 SqlSession 可以共享二级缓存，二级缓存是跨SqlSession</mark>。</p>
<p>  多个不同 SqlSession 共享二级缓存，其作用域是mapper的同一个namespace。<font color="red">当不同的SqlSession，执行同一个 namespace 下相同的sql语句，并且向 sql语句 传递的参数也相同（即最终执行相同的sql语句）。第一次执行sql完毕，会把查询的数据写到缓存（内存）中。当第二次执行相同的sql 查询语句时，会直接从缓存中获取查询数据。不会去底层数据库中进行查询。</font></p>
<p>Mybatis-config.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>settings</span><span class="token punctuation">></span></span>
	<span class="token comment" spellcheck="true">&lt;!--开启二级缓存 ，该属性默认为 false--></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cacheEnabled<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>settings</span><span class="token punctuation">></span></span>
</pre>
<p>UserMapper.xml</p>
<pre class="language-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cache</span> <span class="token attr-name">eviction</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>LRU<span class="token punctuation">"</span></span> <span class="token attr-name">flushInterval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60000<span class="token punctuation">"</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>512<span class="token punctuation">"</span></span> <span class="token attr-name">readOnly</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token comment" spellcheck="true">&lt;!--
以上创建了以后 LRU 缓存，并每隔60 s 刷新，最大存储对象为 512 个，并且返回的对象为只读。

cache元素用于开启当前 mapper 的 namespace 下的二级缓存：

eviction：收回策略（当缓存爆满时），默认为LRU，
	LRU:最近最少使用的策略，移除最长时间不使用的对象缓存。
	FIFO：先进先出策略，按对象进入缓存的顺序来移除它们。
	SOFT：软引用策略，移除基于垃圾回收器状态和软引用规则的对象。
	WEAK：弱引用策略，跟快的移除基于垃圾回收器状态和弱引用规则的对象。

fulshInterval：刷新间隔，缓存多长时间清空一次。
size: 缓存数目，默认值为1024.
readOnly:只读，属性值为 true，false，默认为false。 
	
	当为true 时，mybatis会认为所有从缓存中获取数据的操作，都是只读的操作。给使用者返回缓存对象的数据引用，该引用无法被修改。
	
	当为false 时，mybatis会认为所有从缓存中获取数据的操作都是非只读的操作。会返回缓存对象的拷贝（通过序列化与反序列化），该对象的拷贝可以修改数据，速度慢，会比只读安全些。

--></span>
</pre>
<p>禁用当前Mapper映射文件中的sql语句是否开启二级缓存。<br>
UserMapper.xml</p>
<pre class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>...<span class="token punctuation">"</span></span> <span class="token attr-name">useCache</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>false<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
</pre>
<p><strong>注意：</strong><br>
<font color="red">查询出来的数据默认会放在一级缓存中，只有当SqlSession 提交，关闭时，一级缓存的数据转移到二级缓存中，并清空一级缓存。</font></p>
<h2 class="mume-header" id="mybatis&#x7684;&#x57FA;&#x4E8E;&#x6CE8;&#x89E3;&#x7684;&#x65B9;&#x5F0F;&#x7684;&#x4F7F;&#x7528;">Mybatis的基于注解的方式的使用：</h2>

<h3 class="mume-header" id="1&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;">1.配置与使用：</h3>

<p>  Mybatis提供了比使用XML更加简便的基于注解（Annotation）的方式使用Mybatis。<br>
<font color="red">当使用注解的方式使用Mybatis时，相比XML方式：</font></p>
<blockquote>
<ol>
<li>不需要编写持久化类与数据表之间的~Mapper.xml映射文件，</li>
<li>只需要编写dao接口（代理接口）文件，sql语句写在注解中，放到dao接口（代理接口）文件中，</li>
<li>只需要在Mybatis-config配置文件中修改配置，告诉Mybatis去哪寻找dao接口文件（代理接口）即可。而不是寻找Mapper.xml映射文件（基于XML方式）。</li>
</ol>
</blockquote>
<p>在基于XMl使用Mybatis的项目中加入了 com.entity.dao2 包，专门存放使用注解的dao接口（代理接口）。</p>
<p>com.entity.dao2.Studentdao_Annotation.java</p>
<pre class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>dao2<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Delete<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Insert<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Options<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Param<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Results<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Select<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>Update<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>entity<span class="token punctuation">.</span>Student<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Studentdao_Annotation</span> <span class="token punctuation">{</span>
	
	<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into student(name,age) values(#{name},#{age})"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertstudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into student(name,age) values(#{name},#{age})"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>keyProperty<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertstudent_2</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	
	<span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">" delete from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deletestudentByid</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">" delete from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deletestudentByid_2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">"update student set name=#{name},age=#{age} where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updatestudentByid</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> Student <span class="token function">selectByid</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">)</span>

	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> Student <span class="token function">selectByid_2</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>

</pre>
<p>Mybatis-config.xml</p>
<pre class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- mappers标签告诉mybatis去哪里找sql（持久化类的）映射文件,哪里找代理接口文件 --></span>
		 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/studentMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/School_classMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/dao/TeacherMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span> 
		 		
		 		<span class="token comment" spellcheck="true">&lt;!-- 这是当mybatis使用注解的方式的配置，上面是mybatis使用xml方式配置 --></span>
		 		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.dao2.Studentdao_Annotation<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span>

</pre>
<p>main2.java(用于测试基于注解的Mybatis的使用方式)</p>
<pre class="language-java"><span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
		
		<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
		InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
		  SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
		<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
		SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
		Studentdao_Annotation mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>Studentdao_Annotation<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Student stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		stu<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		Student a<span class="token operator">=</span>mapper<span class="token punctuation">.</span><span class="token function">selectByid</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		
	<span class="token punctuation">}</span>
</pre>
<hr>
<h3 class="mume-header" id="2mybatis&#x5E38;&#x7528;&#x6CE8;&#x89E3;">2.Mybatis常用注解：</h3>

<p>在上面代码中：</p>
<pre class="language-java">	<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into student(name,age) values(#{name},#{age})"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertstudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into student(name,age) values(#{name},#{age})"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>useGeneratedKeys<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>keyProperty<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertstudent_2</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>@Insert：用于映射插入的sql语句。<br>
@Options：在映射语句上作为附加功能的配置出现。<br>
  useGeneratedKeys：该属性为true 表示使用数据库自动增长的主键。该操作需要数据库的支持。<br>
  keyProperty=&quot;id&quot; ：表示将插入数据生成的主键设置到 stu对象的id中。</p>
<hr>
<pre class="language-java">	<span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">" delete from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deletestudentByid</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">" delete from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deletestudentByid_2</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>@Delete ：用于映射删除的sql语句。<br>
@Param ：<font color="red">当方法需要多个参数时，该注解用于给每个参数取一个名字。否则，默认多参数将会以它们的顺序位置和方法对应注解中的sql语句的表达式（#{xxx},#{xxx},...），进行映射。</font><br>
  @Param(&quot;id&quot;) Integer id  ： @Param(&quot;id&quot;) 表示给该注解后面的变量取一个参数名称，对应注解中的#{id}。</p>
<hr>
<pre class="language-java">	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> Student <span class="token function">selectByid</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from student where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">)</span>

	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token keyword">public</span> Student <span class="token function">selectByid_2</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>@Select: 用于映射查询的sql语句。<br>
@Results :多个结果映射（@Result）的列表。<br>
@Result：<font color="red">用于列与结果的单独映射关系。如果查询结果的列与属性名称相同，可以省略，Mybatis会进行自动映射。</font><br>
  id 属性：true/false，表示是否用于主键映射。<br>
  column属性：查询结果数据中对应的列名。<br>
  one 属性：是单独的联系，类似与XML配置的 <mark>&lt;association&gt;标签。</mark><br>
  many属性：对集合而言，，类似与XML配置的 <mark>&lt;collection&gt; 标签。</mark></p>
<h3 class="mume-header" id="2&#x57FA;&#x4E8E;&#x6CE8;&#x89E3;&#x65B9;&#x5F0F;&#x7684;&#x5173;&#x8054;&#x67E5;&#x8BE2;">2.基于注解方式的关联查询：</h3>

<h4 class="mume-header" id="1&#x4E00;&#x5BF9;&#x4E00;&#x5173;&#x8054;&#x67E5;&#x8BE2;">1.一对一关联查询：</h4>

<p>参考链接：<br>
<a href="http://blog.csdn.net/gluawwa/article/details/53289162">注解关联查询</a></p>
<p>Studentdao_Annotation.java</p>
<pre class="language-java"><span class="token comment" spellcheck="true">//注解方式的一对一关联查询============================</span>

	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"SELECT s.*,sc.id scid,sc.name scname from student s LEFT JOIN school_class sc on s.class_id=sc.id where s.id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"sclass"</span><span class="token punctuation">,</span>
				column<span class="token operator">=</span><span class="token string">"class_id"</span><span class="token punctuation">,</span>one<span class="token operator">=</span><span class="token annotation punctuation">@One</span><span class="token punctuation">(</span>
				select<span class="token operator">=</span><span class="token string">"com.dao2.School_classdao_Annotation.selectByid"</span>
				<span class="token punctuation">)</span>
		<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> Student <span class="token function">select_stu_class</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p><font color="red">其中：</font></p>
<pre class="language-java"><span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"sclass"</span><span class="token punctuation">,</span>
	column<span class="token operator">=</span><span class="token string">"class_id"</span><span class="token punctuation">,</span>one<span class="token operator">=</span><span class="token annotation punctuation">@One</span><span class="token punctuation">(</span>
	select<span class="token operator">=</span><span class="token string">"com.dao2.School_classdao_Annotation.selectByid"</span>
				<span class="token punctuation">)</span>
		<span class="token punctuation">)</span>
</pre>
<p>one 属性：是单独的联系，类似与XML配置的 <mark>&lt;association&gt;标签。</mark></p>
<p>这段代码表示为关联对象的结果集映射规则。含义为：<mark>把 column属性的值作为参数，传给select 属性的值指向的方法中，方法返回的结果封装给property 属性值所代表的对象中。</mark></p>
<p>com.dao2.School_classdao_Annotation.selectByid:</p>
<pre class="language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from school_class where id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> School_class <span class="token function">selectByid</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>main2.java</p>
<pre class="language-java"><span class="token comment" spellcheck="true">//注解方式的一对一关联查询</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

		Studentdao_Annotation mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>Studentdao_Annotation<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		Student a<span class="token operator">=</span>mapper<span class="token punctuation">.</span><span class="token function">select_stu_class</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
		
	<span class="token punctuation">}</span>
</pre>
<h4 class="mume-header" id="2&#x4E00;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x67E5;&#x8BE2;">2.一对多关联查询 ？：</h4>

<p>参考链接：<br>
<a href="http://blog.csdn.net/linhaiyun_ytdx/article/details/68947723">注解关联查询</a></p>
<p>通过班级查询班级下的多个学生：</p>
<p>School_classdao_Annotation.java</p>
<pre class="language-java"><span class="token comment" spellcheck="true">//通过班级号查询单个班级，以及多个学生，一对多关联查询</span>
	<span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select sc.* ,s.id sid,s.name sname, s.age sage, s.class_id scid from school_class sc LEFT JOIN student s on sc.id=s.class_id where sc.id=#{id}"</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Results</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">,</span>property<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token annotation punctuation">@Result</span><span class="token punctuation">(</span>property<span class="token operator">=</span><span class="token string">"stulist"</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token annotation punctuation">@Many</span><span class="token punctuation">(</span>
				select<span class="token operator">=</span><span class="token string">"com.dao2.Studentdao_Annotation.selectByclass_id"</span>
				<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> List<span class="token operator">&lt;</span>School_class<span class="token operator">></span> <span class="token function">select_class_student</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>@Result 的 many属性：对集合而言，，类似与XML配置的 <mark>&lt;collection&gt; 标签。</mark><br>
这段代码表示为关联对象的结果集映射规则。含义为：<mark>把 column属性的值作为参数，传给select 属性的值指向的方法中，方法返回的结果封装给property 属性值所代表的对象中。</mark></p>
<p><img src="../img/mybatis_img/19.png" alt="&#x5728;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#x7684;&#x622A;&#x56FE;"></p>
<pre class="language-java"> <span class="token keyword">public</span> List<span class="token operator">&lt;</span>School_class<span class="token operator">></span> <span class="token function">select_class_student</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>   
</pre>
<p><font color="red">这段代码返回了两个School_class对象，两个对象一摸一样。暂时不知为什么。</font></p>
<p>com.dao2.Studentdao_Annotation.selectByclass_id :</p>
<pre class="language-java"><span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select id,name,age from student where class_id=#{id}"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> Student <span class="token function">selectByclass_id</span><span class="token punctuation">(</span>Integer id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
</pre>
<p>测试：</p>
<pre class="language-java"><span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
	School_classdao_Annotation mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>School_classdao_Annotation<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	List<span class="token operator">&lt;</span>School_class<span class="token operator">></span> a<span class="token operator">=</span>mapper<span class="token punctuation">.</span><span class="token function">select_class_student</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//由于会查询多条数据</span>
	session<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
<p>控制台打印的sql语句：</p>
<blockquote>
<p>[School_class [id=2, name=B, stulist=[Student [id=7, name=xiaoming, age=12, sclass=null, tealist=null], Student [id=8, name=hui, age=22, sclass=null, tealist=null]], tealist=null],<br>
School_class [id=2, name=B, stulist=[Student [id=7, name=xiaoming, age=12, sclass=null, tealist=null], Student [id=8, name=hui, age=22, sclass=null, tealist=null]], tealist=null]]</p>
</blockquote>
<p><strong>这段代码返回了两个School_class对象，两个对象一摸一样。暂时不知为什么.</strong></p>
<h4 class="mume-header" id="3&#x591A;&#x5BF9;&#x591A;&#x5173;&#x8054;&#x67E5;&#x8BE2;&#x61D2;&#x5F97;&#x5199;&#x597D;&#x9EBB;&#x70E6;">3.多对多关联查询(懒得写，好麻烦):</h4>

<p>参考链接：<br>
<a href="http://blog.csdn.net/linhaiyun_ytdx/article/details/68947739">基于注解多对多关联查询</a></p>
<h3 class="mume-header" id="3&#x57FA;&#x4E8E;&#x6CE8;&#x89E3;&#x65B9;&#x5F0F;&#x7684;&#x52A8;&#x6001;sql">3.基于注解方式的动态SQL：</h3>

<ol>
<li>新建一个代理接口：</li>
</ol>
<p>com.dao3.studentdao_dynamicSQL:</p>
<pre class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">studentdao_dynamicSQL</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">//其中的 type 属性指定一个类，method 属性指定该类的某个方法，方法根据参数返回不同的sql语句。</span>

	<span class="token annotation punctuation">@SelectProvider</span><span class="token punctuation">(</span>type<span class="token operator">=</span>student_DynamicSQL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">"selectstudent_dynamic"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> List<span class="token operator">&lt;</span>Student<span class="token operator">></span> <span class="token function">selectstudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@InsertProvider</span><span class="token punctuation">(</span>type<span class="token operator">=</span>student_DynamicSQL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">"insertstudent_dynamic"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertstudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@UpdateProvider</span><span class="token punctuation">(</span>type<span class="token operator">=</span>student_DynamicSQL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">"updatestudent_dynamic"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updatestudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token annotation punctuation">@DeleteProvider</span><span class="token punctuation">(</span>type<span class="token operator">=</span>student_DynamicSQL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>method<span class="token operator">=</span><span class="token string">"deletestudent_dynamic"</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deletestudent</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>
</pre>
<p><strong>@SelectProvider,@InsertProvider,@UpdateProvider,@DeleteProvider 这四个注解支持动态sql，<font color="red">其中的 type 属性指定一个类，method 属性指定该类的某个方法，方法根据参数返回不同的sql语句。</font></strong></p>
<ol start="2">
<li>创建注解指向的类与方法：</li>
</ol>
<p>com.dao3.student_DynamicSQL:</p>
<pre class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">student_DynamicSQL</span> <span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">//基于注解方式的动态查询，根据传入的参数，返回不同的sql语句</span>
	<span class="token keyword">public</span> String <span class="token function">selectstudent_dynamic</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token punctuation">{</span>
				<span class="token function">SELECT</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">FROM</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">" id = #{id} "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">" name = #{name} "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">" age = #{age} "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
	
	<span class="token comment" spellcheck="true">//基于注解方式的动态insert，根据传入的参数，返回不同的sql语句</span>
	<span class="token keyword">public</span> String <span class="token function">insertstudent_dynamic</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token punctuation">{</span>
				<span class="token function">INSERT_INTO</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">VALUES</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"#{id}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">VALUES</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"#{name}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">VALUES</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"#{age}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
	
	<span class="token comment" spellcheck="true">//基于注解方式的动态update,根据传入的参数，返回不同的sql语句</span>
	<span class="token keyword">public</span> String <span class="token function">updatestudent_dynamic</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token punctuation">{</span>
				<span class="token function">UPDATE</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">SET</span><span class="token punctuation">(</span><span class="token string">"name = #{name}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token function">SET</span><span class="token punctuation">(</span><span class="token string">"age = #{age}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">"id = #{id} "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">//基于注解方式的动态delete,根据传入的参数，返回不同的sql语句</span>
		<span class="token keyword">public</span> String <span class="token function">deletestudent_dynamic</span><span class="token punctuation">(</span>Student stu<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SQL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token punctuation">{</span>
					<span class="token function">DELETE_FROM</span><span class="token punctuation">(</span><span class="token string">"student"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">"id = #{id}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">"name = #{name}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token function">WHERE</span><span class="token punctuation">(</span><span class="token string">"age = #{age}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>	
				<span class="token punctuation">}</span>	
			<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</pre>
<p>其中的<font color="red">WHERE,SET,INSERT,VALUES,INSERT_INTO</font>,...这些函数是由Mybatis提供。<br>
Mybatis中有一个SQL 工具类org.apache.ibatis.jdbc.SQL ,该类不适用字符串拼接的方式，并且会以合适的空格前缀，后缀来构造SQL语句。</p>
<ol start="3">
<li>测试：</li>
</ol>
<pre class="language-java"><span class="token annotation punctuation">@Test</span>	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">//通过这句来读取xml 配置文件的信息</span>
			InputStream inputs<span class="token operator">=</span>Resources<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mybatis_config.xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">//初始化mybatis ， 创建SqlSessionFactory，通过xml配置文件信息</span>
			  SqlSessionFactory ssf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">//实例化session 对象，通过SqlSessionFactory</span>
			<span class="token comment" spellcheck="true">//SqlSession session=ssf.openSession(true);  若实例化openSeeion的构造方法，就可以自动提交，不用手动提交。</span>
			SqlSession session<span class="token operator">=</span>ssf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">//通过session对象，用反射的方式，获取代理接口的实例化对象，这段代码，相当于实例化接口对象</span>
			studentdao_dynamicSQL mapper <span class="token operator">=</span>session<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>studentdao_dynamicSQL<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Student stu<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			stu<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
			List<span class="token operator">&lt;</span>Student<span class="token operator">></span> a<span class="token operator">=</span>mapper<span class="token punctuation">.</span><span class="token function">selectstudent</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">//session.commit();</span>
			System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
			session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
</pre>
<h2 class="mume-header" id="mybatis&#x7684;&#x4E8B;&#x52A1;&#x770B;&#x53C2;&#x8003;&#x94FE;&#x63A5;">Mybatis的事务(看参考链接)：</h2>

<p>  <strong>多条sql语句访问数据库的过程叫事务，事务是一个最小的逻辑执行单元，整个事务不能分开执行，要么同时执行，要么同时不执行，绝不能执行一部分（当你从银行转账，如果你的账户钱少了，那别人的账户钱多了。一定不能出现你的钱少了，别人的钱不变。）。</strong></p>
<p>参考链接：<br>
<a href="http://blog.csdn.net/luanlouis/article/details/37992171">MyBatis事务管理机制</a></p>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#mybatis">Mybatis</a>
<ul>
<li><a href="#%E6%A6%82%E8%BF%B0">概述：</a></li>
<li><a href="#orm%E6%A1%86%E6%9E%B6">ORM框架：</a>
<ul>
<li><a href="#1%E6%A6%82%E8%BF%B0">1.概述：</a></li>
<li><a href="#2orm%E6%A1%86%E6%9E%B6%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%98%A0%E5%B0%84%E6%96%B9%E5%BC%8F">2.ORM框架的基本映射方式：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E4%BD%BF%E7%94%A8%E5%89%8D%E6%8F%90">mybatis的使用前提：</a></li>
<li><a href="#mybatis%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6sql%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AE%B2%E8%A7%A3">Mybatis的配置文件（全局配置文件，SQL映射配置文件）讲解：</a>
<ul>
<li><a href="#1mybatis-%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-mybatisconfigxml">1.Mybatis 全局配置文件 Mybatis—config.xml:</a>
<ul>
<li><a href="#2%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">②.引入外部配置文件：</a></li>
<li><a href="#3settings%E6%A0%87%E7%AD%BE%E8%AE%BE%E7%BD%AEmybatis%E7%9A%84%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE%E6%A0%87%E7%AD%BE">③.settings标签，设置Mybatis的主要配置标签：</a></li>
<li><a href="#4typealiases%E6%A0%87%E7%AD%BE%E4%B8%8D%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8">④.typeAliases标签（不推荐使用）：</a></li>
<li><a href="#5environments%E6%A0%87%E7%AD%BE%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">⑤.environments标签，运行环境配置：</a></li>
<li><a href="#6databaseidprovider%E6%A0%87%E7%AD%BE%E6%94%AF%E6%8C%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%90%E8%A1%8C">⑥.databaseIdProvider标签,支持多数据库运行：</a></li>
<li><a href="#7mappers%E6%A0%87%E7%AD%BE">⑦.mappers标签：</a></li>
</ul>
</li>
<li><a href="#2mapper%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6-~mapperxml">2.Mapper映射文件 ~Mapper.xml:</a>
<ul>
<li><a href="#1select">①.select</a></li>
<li><a href="#2insert-update-%E5%92%8C-delete">②.insert, update 和 delete</a></li>
<li><a href="#3%E5%8F%82%E6%95%B0%E5%A4%84%E7%90%86%E5%8D%95%E4%B8%AA%E5%8F%82%E6%95%B0%E5%A4%9A%E4%B8%AA%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1%E9%9B%86%E5%90%88">③.参数处理(单个参数，多个参数,对象，集合)：</a></li>
</ul>
</li>
<li><a href="#3-%E4%B8%8E-%E7%9A%84%E5%8C%BA%E5%88%AB">3.&quot;#{} 与 ${} 的区别&quot;：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84xml%E6%96%B9%E5%BC%8F%E4%BD%BF%E7%94%A8">Mybatis的XML方式使用：</a>
<ul>
<li><a href="#1%E5%AE%89%E8%A3%85mysql%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8">①安装MySQL,创建数据库,创建数据表：</a></li>
<li><a href="#2%E5%88%9B%E5%BB%BA%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%98%A0%E5%B0%84%E7%B1%BBjavabean%E5%AE%9E%E4%BD%93%E7%B1%BB">②创建持久化类（数据库映射类/javaBean/实体类）：</a></li>
<li><a href="#3%E5%88%9B%E5%BB%BAmybatis_configxml-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E5%AD%97blog_demo">③创建Mybatis_config.xml ， 数据库名字：blog_demo</a></li>
<li><a href="#4%E5%88%9B%E5%BB%BAstudentmapperxml-%E6%95%B0%E6%8D%AE%E8%A1%A8%E5%90%8D%E5%AD%97student">④创建studentMapper.xml  ，数据表名字：student</a></li>
<li><a href="#5%E5%88%9B%E5%BB%BAtest%E7%B1%BBmainjava">⑤创建test类，main.java</a></li>
</ul>
</li>
<li><a href="#mybatis-%E6%8E%A5%E5%8F%A3%E5%BC%8F%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F-%E7%9B%B8%E6%AF%94%E4%B9%8B%E5%89%8D%E8%B0%83%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%96%B9%E5%BC%8F%E6%8E%A5%E5%8F%A3%E5%BC%8F%E7%BC%96%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%8F%AA%E8%A6%81%E6%94%B9%E5%8A%A8%E5%87%A0%E4%B8%AA%E5%9C%B0%E6%96%B9">Mybatis 接口式编程方式， （相比之前调用数据库的方式，接口式编程的方式只要改动几个地方）：</a>
<ul>
<li><a href="#1%E5%A2%9E%E5%8A%A0%E4%BB%A3%E7%90%86%E6%8E%A5%E5%8F%A3-studentdaojava">①：增加代理接口： studentdao.java</a></li>
<li><a href="#2%E4%BF%AE%E6%94%B9%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%9A%84%E5%80%BC-studentmapperxml-%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4">②：修改映射文件的命名空间的值---studentMapper.xml 的命名空间：</a></li>
<li><a href="#3%E6%B5%8B%E8%AF%95%E7%B1%BB-mainjava">③测试类 ，main.java</a></li>
</ul>
</li>
<li><a href="#font-colorredresultmap%E6%B3%A8%E9%87%8A%E5%BE%88%E9%87%8D%E8%A6%81font">ResultMap（注释很重要）:</a>
<ul>
<li><a href="#1resultmap%E7%9A%84%E4%BD%9C%E7%94%A8%E6%A6%82%E8%BF%B0">1.ResultMap的作用概述：</a></li>
<li><a href="#2%E8%8B%A5%E8%A1%A8%E7%9A%84%E5%88%97%E5%90%8D%E4%B8%8E%E6%8C%81%E4%B9%85%E5%8C%96%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D%E4%B8%8D%E7%9B%B8%E5%90%8C%E5%8F%AF%E7%94%A8resultmap%E8%A7%A3%E5%86%B3">2.若表的列名与持久化类的属性名不相同，可用ResultMap解决：</a></li>
<li><a href="#3%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2association%E6%A0%87%E7%AD%BE">3.一对一关联查询（association标签）：</a></li>
<li><a href="#4%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2collection%E6%A0%87%E7%AD%BE">4.一对多关联查询（collection标签）：</a></li>
<li><a href="#5%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">5.多对多关联查询：</a>
<ul>
<li><a href="#1%E6%9F%A5%E8%AF%A2%E6%9F%90%E4%B8%AA%E7%8F%AD%E7%BA%A7%E6%97%B6%E6%8A%8A%E7%8F%AD%E7%BA%A7%E6%89%80%E5%9C%A8%E7%9A%84%E5%A4%9A%E4%B8%AA%E8%80%81%E5%B8%88%E4%B9%9F%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">①查询某个班级时，把班级所在的多个老师也查询出来：</a></li>
<li><a href="#2%E6%9F%A5%E8%AF%A2%E6%9F%90%E4%B8%AA%E8%80%81%E5%B8%88%E6%97%B6%E6%8A%8A%E8%80%81%E5%B8%88%E6%89%80%E5%9C%A8%E7%9A%84%E5%A4%9A%E4%B8%AA%E7%8F%AD%E7%BA%A7%E4%B9%9F%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">②查询某个老师时，把老师所在的多个班级也查询出来：</a></li>
<li><a href="#3%E6%8A%8A%E6%9F%A5%E8%AF%A2%E5%85%A8%E9%83%A8%E8%80%81%E5%B8%88%E7%9A%84%E5%90%8C%E6%97%B6%E6%8A%8A%E6%89%80%E6%9C%89%E8%80%81%E5%B8%88%E7%9A%84%E6%89%80%E6%95%99%E7%9A%84%E7%8F%AD%E7%BA%A7%E9%83%BD%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5">③把查询全部老师的同时，把所有老师的所教的班级都查询出来：</a></li>
</ul>
</li>
<li><a href="#6%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E8%A1%A5%E5%85%85">6.关联查询补充：</a>
<ul>
<li><a href="#1%E6%87%92%E5%8A%A0%E8%BD%BD%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD">1.懒加载（延迟加载）：</a></li>
<li><a href="#2%E4%BD%BF%E7%94%A8associationcollection-%E6%A0%87%E7%AD%BE%E8%BF%9B%E8%A1%8C%E5%88%86%E5%B8%83%E6%9F%A5%E8%AF%A2%E6%97%B6%E5%8F%AF%E4%BB%A5%E4%BC%A0%E5%A4%9A%E5%88%97%E7%9A%84%E5%80%BC">2.使用association，collection 标签进行分布查询时，可以传多列的值：</a></li>
<li><a href="#3mybatis%E7%9A%84%E9%89%B4%E5%88%AB%E5%99%A8discriminator">3.MyBatis的鉴别器（discriminator）:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8A%A8%E6%80%81sql">动态SQL:</a>
<ul>
<li><a href="#1if-%E8%AF%AD%E5%8F%A5-%E7%AE%80%E5%8D%95%E7%9A%84%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD">1.if 语句 (简单的条件判断)：</a></li>
<li><a href="#2choose-whenotherwize%E8%AF%AD%E5%8F%A5">2.choose (when,otherwize)语句：</a></li>
<li><a href="#3trim%E6%A0%87%E7%AD%BE%E5%B8%B8%E7%94%A8%E4%B8%89%E7%A7%8D%E7%94%A8%E6%B3%95">3.trim标签（常用，三种用法）</a></li>
<li><a href="#4where">4.where</a></li>
<li><a href="#5set%E8%AF%AD%E5%8F%A5%E9%80%82%E7%94%A8%E4%B8%8E%E5%8A%A8%E6%80%81%E6%9B%B4%E6%96%B0">5.set语句（适用与动态更新）：</a></li>
<li><a href="#6foreach%E8%AF%AD%E5%8F%A5">6.foreach语句：</a></li>
<li><a href="#7bind%E8%AF%AD%E5%8F%A5%E6%88%91%E4%B9%9F%E4%B8%8D%E5%A4%AA%E4%BC%9A">7.bind语句(我也不太会)：</a></li>
<li><a href="#8sqlinclude-%E6%A0%87%E7%AD%BE%E6%8A%BD%E5%8F%96%E5%8F%AF%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8%E7%9A%84sql%E7%89%87%E6%AE%B5%E6%96%B9%E4%BE%BF%E5%BC%95%E7%94%A8">8.sql，include 标签（抽取可重复使用的sql片段，方便引用）：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6">Mybatis的缓存机制：</a>
<ul>
<li><a href="#%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98sqlsession-%E7%BA%A7%E5%88%AB">一级缓存（SqlSession 级别）：</a></li>
<li><a href="#%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98mapper-%E7%BA%A7%E5%88%AB">二级缓存（mapper 级别）：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E7%9A%84%E6%96%B9%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8">Mybatis的基于注解的方式的使用：</a>
<ul>
<li><a href="#1%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8">1.配置与使用：</a></li>
<li><a href="#2mybatis%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3">2.Mybatis常用注解：</a></li>
<li><a href="#2%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E7%9A%84%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">2.基于注解方式的关联查询：</a>
<ul>
<li><a href="#1%E4%B8%80%E5%AF%B9%E4%B8%80%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">1.一对一关联查询：</a></li>
<li><a href="#2%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">2.一对多关联查询 ？：</a></li>
<li><a href="#3%E5%A4%9A%E5%AF%B9%E5%A4%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E6%87%92%E5%BE%97%E5%86%99%E5%A5%BD%E9%BA%BB%E7%83%A6">3.多对多关联查询(懒得写，好麻烦):</a></li>
</ul>
</li>
<li><a href="#3%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8A%A8%E6%80%81sql">3.基于注解方式的动态SQL：</a></li>
</ul>
</li>
<li><a href="#mybatis%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%9C%8B%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">Mybatis的事务(看参考链接)：</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">≡</a>
    </body>
    
    
    
    <script>
(function bindTaskListEvent() {
  var taskListItemCheckboxes = document.body.getElementsByClassName('task-list-item-checkbox')
  for (var i = 0; i < taskListItemCheckboxes.length; i++) {
    var checkbox = taskListItemCheckboxes[i]
    var li = checkbox.parentElement
    if (li.tagName !== 'LI') li = li.parentElement
    if (li.tagName === 'LI') {
      li.classList.add('task-list-item')
    }
  }
}())    
</script>
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  </html>